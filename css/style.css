/* ================================================================
   è›‡å¹´æ¥ç¦ - æ¹–å—ä¿¡æ¯å­¦é™¢è®¡ç®—æœºç§‘å­¦ä¸å·¥ç¨‹å­¦é™¢
   3Då–œåº†ç‰ˆæ ·å¼ - é¡¶çº§æ¸¸æˆè®¾è®¡
================================================================ */

/* ==================== CSSå˜é‡ ==================== */
:root {
    /* ä¸»è‰²è°ƒ */
    --red-primary: #DC143C;
    --red-dark: #8B0000;
    --red-light: #FF6B6B;
    --gold-primary: #FFD700;
    --gold-dark: #DAA520;
    --gold-light: #FFF8DC;

    /* æ¸å˜ */
    --gradient-festive: linear-gradient(135deg, #8B0000 0%, #DC143C 50%, #FF4757 100%);
    --gradient-gold: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FFD700 100%);
    --gradient-night: linear-gradient(180deg, #0a0015 0%, #1a0a2e 30%, #2d1b4e 60%, #1a0a2e 100%);

    /* 3Dæ•ˆæœ */
    --perspective: 1000px;
    --shadow-3d: 0 20px 60px rgba(0,0,0,0.4);
    --glow-gold: 0 0 30px rgba(255, 215, 0, 0.6);
    --glow-red: 0 0 30px rgba(220, 20, 60, 0.6);

    /* åŠ¨ç”»æ—¶é—´ */
    --transition-fast: 0.15s;
    --transition-normal: 0.3s;
    --transition-slow: 0.5s;
}

/* ==================== åŸºç¡€é‡ç½® ==================== */
*, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
    font-family: "PingFang SC", "Microsoft YaHei", "Helvetica Neue", sans-serif;
    -webkit-font-smoothing: antialiased;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
    -webkit-user-select: none;
    perspective: var(--perspective);
    -webkit-touch-callout: none;
}

body {
    background: var(--gradient-festive);
}

/* ==================== å…¨å±æ¨¡å¼ä¼˜åŒ– ==================== */
:fullscreen {
    background: var(--gradient-festive);
}

::backdrop {
    background: var(--gradient-festive);
}

/* iOS Safariå…¨å±ä¼˜åŒ– */
@supports (-webkit-touch-callout: none) {
    html, body {
        min-height: -webkit-fill-available;
    }
}

/* å…¨å±æç¤ºæ–‡å­— */
.fullscreen-hint {
    font-size: 0.75rem;
    color: rgba(255, 215, 0, 0.7);
    margin-top: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
}

.fullscreen-hint::before {
    content: 'ğŸ“±';
}

/* ==================== å…¨å±€æ•ˆæœ ==================== */
.screen {
    position: fixed;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity var(--transition-slow), visibility var(--transition-slow);
    perspective: var(--perspective);
    transform-style: preserve-3d;
}

.screen.active {
    opacity: 1;
    visibility: visible;
}

.screen canvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
}

.hidden { display: none !important; }

/* å±å¹•é—ªå…‰æ•ˆæœ */
.screen-flash {
    position: fixed;
    inset: 0;
    background: white;
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
    transition: opacity 0.1s;
}

.screen-flash.active {
    opacity: 0.8;
}

/* å±å¹•éœ‡åŠ¨ */
@keyframes screenShake {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-10px) rotate(-1deg); }
    40% { transform: translateX(10px) rotate(1deg); }
    60% { transform: translateX(-5px) rotate(-0.5deg); }
    80% { transform: translateX(5px) rotate(0.5deg); }
}

.shake {
    animation: screenShake 0.4s ease-out;
}

/* ==================== åŠ è½½é¡µé¢3D ==================== */
#loading-screen {
    background: radial-gradient(ellipse at center, #DC143C 0%, #8B0000 100%);
}

.loading-3d-container {
    perspective: 1000px;
    transform-style: preserve-3d;
}

.loading-content {
    text-align: center;
    transform-style: preserve-3d;
    animation: loadingFloat 2s ease-in-out infinite;
}

@keyframes loadingFloat {
    0%, 100% { transform: translateY(0) rotateX(0deg); }
    50% { transform: translateY(-20px) rotateX(5deg); }
}

.loading-snake-3d {
    position: relative;
    margin-bottom: 30px;
}

.snake-emoji {
    font-size: 6rem;
    display: inline-block;
    animation: snakeRotate3d 2s ease-in-out infinite;
    filter: drop-shadow(0 20px 30px rgba(0,0,0,0.5));
}

@keyframes snakeRotate3d {
    0%, 100% { transform: rotateY(0deg) scale(1); }
    25% { transform: rotateY(15deg) scale(1.1); }
    50% { transform: rotateY(0deg) scale(1); }
    75% { transform: rotateY(-15deg) scale(1.1); }
}

.snake-shadow {
    position: absolute;
    bottom: -30px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 20px;
    background: radial-gradient(ellipse, rgba(0,0,0,0.4) 0%, transparent 70%);
    animation: shadowPulse 2s ease-in-out infinite;
}

@keyframes shadowPulse {
    0%, 100% { transform: translateX(-50%) scale(1); opacity: 0.4; }
    50% { transform: translateX(-50%) scale(0.6); opacity: 0.2; }
}

.loading-text {
    display: flex;
    justify-content: center;
    gap: 5px;
    margin-bottom: 25px;
}

.char-3d {
    font-size: 1.8rem;
    color: var(--gold-primary);
    text-shadow:
        2px 2px 0 var(--red-dark),
        0 0 20px rgba(255, 215, 0, 0.8);
    animation: charBounce3d 0.6s ease-in-out infinite;
    display: inline-block;
}

.char-3d:nth-child(1) { animation-delay: 0s; }
.char-3d:nth-child(2) { animation-delay: 0.1s; }
.char-3d:nth-child(3) { animation-delay: 0.2s; }
.char-3d:nth-child(4) { animation-delay: 0.3s; }
.char-3d:nth-child(5) { animation-delay: 0.4s; }

@keyframes charBounce3d {
    0%, 100% { transform: translateY(0) rotateX(0deg); }
    50% { transform: translateY(-10px) rotateX(10deg); }
}

.dots {
    color: var(--gold-primary);
    font-size: 1.8rem;
    animation: dotsFlash 1s steps(3) infinite;
}

@keyframes dotsFlash {
    0% { opacity: 0.3; }
    33% { opacity: 0.6; }
    66% { opacity: 1; }
}

.loading-bar-3d {
    width: 250px;
    height: 12px;
    background: rgba(0,0,0,0.4);
    border-radius: 6px;
    margin: 0 auto 25px;
    position: relative;
    overflow: hidden;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
    transform: perspective(100px) rotateX(5deg);
}

.loading-progress-3d {
    height: 100%;
    width: 0%;
    background: var(--gradient-gold);
    border-radius: 6px;
    animation: loadProgress3d 2s ease-out forwards;
    position: relative;
}

.loading-glow {
    position: absolute;
    top: 0;
    right: 0;
    width: 30px;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
    animation: glowMove 2s ease-out forwards;
}

@keyframes loadProgress3d {
    0% { width: 0%; }
    100% { width: 100%; }
}

@keyframes glowMove {
    0% { right: 100%; }
    100% { right: -30px; }
}

.college-loading {
    color: var(--gold-light);
    font-size: 0.9rem;
    letter-spacing: 2px;
    opacity: 0.8;
}

/* ==================== å¼€å§‹é¡µé¢3D ==================== */
#start-screen {
    background: var(--gradient-festive);
    /* ğŸ“± ç§»åŠ¨ç«¯å…è®¸æ»šåŠ¨ */
    display: block !important;
    overflow-y: auto !important;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y;
}

.festive-overlay {
    position: absolute;
    inset: 0;
    background:
        radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 107, 107, 0.1) 0%, transparent 50%);
    pointer-events: none;
}

.decoration-layer {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
}

/* 3Dç¯ç¬¼ */
.lantern-string {
    position: absolute;
    top: -10px;
    left: 0;
    right: 0;
    display: flex;
    justify-content: center;
    gap: 30px;
    perspective: 500px;
}

.lantern-3d {
    width: calc(40px * var(--size, 1));
    height: calc(60px * var(--size, 1));
    background: linear-gradient(180deg, #FF0000 0%, #CC0000 40%, #990000 100%);
    border-radius: 50% 50% 45% 45%;
    position: relative;
    transform-style: preserve-3d;
    animation: lanternSwing3d 3s ease-in-out infinite;
    animation-delay: var(--delay, 0s);
    box-shadow:
        0 0 40px rgba(255, 0, 0, 0.6),
        inset 0 -15px 30px rgba(0,0,0,0.3),
        inset 0 10px 20px rgba(255,200,0,0.2);
}

.lantern-3d::before {
    content: '';
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: calc(25px * var(--size, 1));
    height: calc(18px * var(--size, 1));
    background: linear-gradient(180deg, var(--gold-primary) 0%, var(--gold-dark) 100%);
    border-radius: 4px 4px 0 0;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

.lantern-3d::after {
    content: 'ç¦';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--gold-primary);
    font-size: calc(18px * var(--size, 1));
    font-weight: bold;
    text-shadow: 0 0 5px rgba(255, 215, 0, 0.8);
}

@keyframes lanternSwing3d {
    0%, 100% { transform: rotateZ(-10deg) rotateY(-5deg); }
    50% { transform: rotateZ(10deg) rotateY(5deg); }
}

/* å†…å®¹3Då®¹å™¨ */
.content-3d {
    position: relative;
    z-index: 10;
    text-align: center;
    padding: 50px 20px 40px 20px;
    max-width: 450px;
    width: 95%;
    margin: 0 auto;
    transform-style: preserve-3d;
}

/* å­¦é™¢æ ‡è¯† */
.college-badge {
    position: relative;
    margin-bottom: 15px;
    perspective: 500px;
}

.badge-inner {
    display: inline-flex;
    align-items: center;
    gap: 12px;
    background: linear-gradient(135deg, rgba(139, 0, 0, 0.9), rgba(100, 0, 0, 0.95));
    padding: 12px 25px;
    border-radius: 30px;
    border: 2px solid var(--gold-primary);
    box-shadow: var(--shadow-3d), var(--glow-gold);
    transform: rotateX(5deg);
    transition: transform var(--transition-normal);
}

.badge-inner:hover {
    transform: rotateX(0deg) scale(1.02);
}

.badge-icon {
    font-size: 2rem;
    animation: badgeFloat 2s ease-in-out infinite;
}

@keyframes badgeFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

.badge-text {
    text-align: left;
}

.college-name {
    color: var(--gold-primary);
    font-size: 1rem;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

.department-name {
    color: var(--gold-light);
    font-size: 0.75rem;
    opacity: 0.9;
}

.badge-glow {
    position: absolute;
    inset: -5px;
    border-radius: 35px;
    background: var(--gold-primary);
    filter: blur(15px);
    opacity: 0.3;
    z-index: -1;
    animation: glowPulse 2s ease-in-out infinite;
}

@keyframes glowPulse {
    0%, 100% { opacity: 0.2; transform: scale(1); }
    50% { opacity: 0.4; transform: scale(1.05); }
}

/* 3Dæ ‡é¢˜ */
.title-3d-container {
    margin: 20px 0;
    perspective: 800px;
    transform-style: preserve-3d;
}

.year-ribbon {
    display: inline-block;
    background: var(--gradient-gold);
    padding: 6px 25px;
    border-radius: 20px;
    margin-bottom: 15px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 5px 20px rgba(255, 165, 0, 0.4);
}

.ribbon-text {
    color: var(--red-dark);
    font-size: 0.9rem;
    font-weight: bold;
    position: relative;
    z-index: 1;
}

.ribbon-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
    animation: ribbonShine 3s ease-in-out infinite;
}

@keyframes ribbonShine {
    0%, 100% { left: -100%; }
    50% { left: 100%; }
}

.game-title-3d {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 10px;
    transform-style: preserve-3d;
}

.title-char-3d {
    font-size: clamp(3.5rem, 14vw, 5rem);
    font-weight: bold;
    color: var(--gold-primary);
    text-shadow:
        5px 5px 0 var(--red-dark),
        -2px -2px 0 var(--gold-light),
        0 0 50px rgba(255, 215, 0, 0.8),
        0 0 100px rgba(255, 215, 0, 0.4);
    display: inline-block;
    animation: titleFloat3d 2.5s ease-in-out infinite;
    transform-style: preserve-3d;
    position: relative;
}

.title-char-3d::after {
    content: attr(data-char);
    position: absolute;
    left: 0;
    top: 0;
    color: transparent;
    -webkit-text-stroke: 2px rgba(255, 215, 0, 0.3);
    transform: translateZ(-20px);
    filter: blur(2px);
}

.title-char-3d:nth-child(1) { animation-delay: 0s; }
.title-char-3d:nth-child(2) { animation-delay: 0.15s; }
.title-char-3d:nth-child(3) { animation-delay: 0.3s; }
.title-char-3d:nth-child(4) { animation-delay: 0.45s; }

@keyframes titleFloat3d {
    0%, 100% {
        transform: translateY(0) rotateX(0deg) translateZ(0);
    }
    50% {
        transform: translateY(-15px) rotateX(10deg) translateZ(20px);
    }
}

.title-reflection {
    height: 30px;
    background: linear-gradient(180deg, rgba(255, 215, 0, 0.3) 0%, transparent 100%);
    transform: scaleY(-1) translateY(-10px);
    filter: blur(3px);
    opacity: 0.5;
}

/* è›‡å½¢Logo3D */
.snake-logo-3d {
    position: relative;
    margin: 15px 0;
    perspective: 500px;
}

.snake-body-3d {
    display: inline-block;
}

.segment {
    font-size: 4rem;
    display: inline-block;
    animation: snakeWave3d 2s ease-in-out infinite;
    filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
}

@keyframes snakeWave3d {
    0%, 100% {
        transform: translateX(0) scaleX(1) rotateY(0deg);
    }
    25% {
        transform: translateX(-20px) scaleX(-1) rotateY(-20deg);
    }
    50% {
        transform: translateX(0) scaleX(-1) rotateY(0deg);
    }
    75% {
        transform: translateX(20px) scaleX(1) rotateY(20deg);
    }
}

.snake-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100px;
    height: 100px;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.4) 0%, transparent 70%);
    animation: snakeGlow 2s ease-in-out infinite;
}

@keyframes snakeGlow {
    0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.4; }
    50% { transform: translate(-50%, -50%) scale(1.3); opacity: 0.7; }
}

/* æœ€é«˜åˆ†å¡ç‰‡3D */
.high-score-card-3d {
    position: relative;
    display: inline-block;
    margin-bottom: 15px;
    perspective: 500px;
}

.card-face {
    display: flex;
    align-items: center;
    gap: 10px;
    background: linear-gradient(135deg, rgba(0,0,0,0.5), rgba(0,0,0,0.7));
    padding: 10px 25px;
    border-radius: 30px;
    border: 2px solid rgba(255, 215, 0, 0.5);
    transform: rotateX(5deg);
    transition: all var(--transition-normal);
}

.card-face:hover {
    transform: rotateX(0deg) scale(1.05);
    border-color: var(--gold-primary);
}

.trophy {
    font-size: 1.5rem;
    animation: trophyBounce 1.5s ease-in-out infinite;
}

@keyframes trophyBounce {
    0%, 100% { transform: scale(1) rotate(0deg); }
    50% { transform: scale(1.2) rotate(-10deg); }
}

.hs-label {
    color: var(--gold-light);
    font-size: 0.85rem;
}

.hs-value {
    color: var(--gold-primary);
    font-size: 1.5rem;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
}

.hs-unit {
    color: var(--gold-light);
    font-size: 0.85rem;
}

.card-shine {
    position: absolute;
    inset: 0;
    border-radius: 30px;
    background: linear-gradient(135deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%);
    animation: cardShine 4s ease-in-out infinite;
}

@keyframes cardShine {
    0%, 100% { opacity: 0; }
    50% { opacity: 1; }
}

/* ç©æ³•å¡ç‰‡3D */
.instruction-card-3d {
    background: linear-gradient(145deg, rgba(139, 0, 0, 0.9), rgba(80, 0, 0, 0.95));
    border-radius: 25px;
    overflow: hidden;
    margin: 15px 0;
    border: 3px solid var(--gold-primary);
    box-shadow:
        var(--shadow-3d),
        inset 0 1px 0 rgba(255,255,255,0.1),
        0 0 30px rgba(255, 215, 0, 0.3);
    transform: perspective(500px) rotateX(3deg);
    transition: transform var(--transition-normal);
}

.instruction-card-3d:hover {
    transform: perspective(500px) rotateX(0deg);
}

.card-header-3d {
    background: var(--gradient-gold);
    padding: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.header-icon {
    font-size: 1.2rem;
    animation: iconSpin 3s linear infinite;
}

@keyframes iconSpin {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(360deg); }
}

.header-text {
    color: var(--red-dark);
    font-size: 1.1rem;
    font-weight: bold;
}

.card-body-3d {
    padding: 15px;
}

.item-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    margin-bottom: 12px;
}

.item-3d {
    background: rgba(0,0,0,0.4);
    border-radius: 15px;
    padding: 12px 8px;
    position: relative;
    overflow: hidden;
    transform: translateZ(0);
    transition: all var(--transition-fast);
    border: 2px solid transparent;
}

.item-3d:hover {
    transform: translateY(-5px) scale(1.05);
}

.item-3d.positive { border-bottom: 3px solid #4CAF50; }
.item-3d.special { border-bottom: 3px solid var(--gold-primary); }
.item-3d.bonus { border-bottom: 3px solid #9C27B0; }
.item-3d.negative { border-bottom: 3px solid #F44336; }

.item-emoji {
    font-size: 1.4rem;
    margin-bottom: 6px;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.12em;
    line-height: 1.12;
    min-height: calc(1em * 1.2);
}

.item-emoji span {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    min-width: 1em;
}

.item-label {
    font-size: 0.7rem;
    color: rgba(255,255,255,0.9);
}

.item-glow {
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity var(--transition-fast);
}

.item-glow.green { background: radial-gradient(circle, rgba(76, 175, 80, 0.3) 0%, transparent 70%); }
.item-glow.gold { background: radial-gradient(circle, rgba(255, 215, 0, 0.3) 0%, transparent 70%); }
.item-glow.purple { background: radial-gradient(circle, rgba(156, 39, 176, 0.3) 0%, transparent 70%); }
.item-glow.red { background: radial-gradient(circle, rgba(244, 67, 54, 0.3) 0%, transparent 70%); }

.item-3d:hover .item-glow {
    opacity: 1;
}

.combo-tip {
    background: linear-gradient(90deg, rgba(255, 100, 0, 0.3), rgba(255, 50, 0, 0.3));
    padding: 10px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    color: #FFF;
    font-size: 0.85rem;
}

.fire-icon {
    animation: fireFlicker 0.3s ease-in-out infinite alternate;
}

@keyframes fireFlicker {
    0% { transform: scale(1); filter: brightness(1); }
    100% { transform: scale(1.3); filter: brightness(1.5); }
}

/* 3Då¼€å§‹æŒ‰é’® - é«˜äº®è„‰å†²æ•ˆæœ */
.btn-start-3d {
    position: relative;
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 40%, #FFD700 60%, #FFEC8B 100%);
    border: 3px solid #FFD700;
    padding: 20px 60px;
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--red-dark);
    border-radius: 50px;
    cursor: pointer;
    overflow: visible;
    margin: 20px 0;
    transform-style: preserve-3d;
    transform: perspective(500px) rotateX(5deg);
    transition: all var(--transition-normal);
    box-shadow:
        0 0 30px rgba(255, 215, 0, 0.8),
        0 0 60px rgba(255, 165, 0, 0.5),
        0 15px 35px rgba(255, 165, 0, 0.5),
        0 5px 15px rgba(0,0,0,0.3),
        inset 0 2px 0 rgba(255,255,255,0.5);
    /* ğŸŒŸ é«˜äº®è„‰å†²åŠ¨ç”» */
    animation: btnGlowPulse 1.5s ease-in-out infinite;
}

@keyframes btnGlowPulse {
    0%, 100% {
        box-shadow:
            0 0 30px rgba(255, 215, 0, 0.8),
            0 0 60px rgba(255, 165, 0, 0.5),
            0 15px 35px rgba(255, 165, 0, 0.5),
            0 5px 15px rgba(0,0,0,0.3),
            inset 0 2px 0 rgba(255,255,255,0.5);
    }
    50% {
        box-shadow:
            0 0 50px rgba(255, 215, 0, 1),
            0 0 80px rgba(255, 165, 0, 0.7),
            0 20px 45px rgba(255, 165, 0, 0.6),
            0 8px 20px rgba(0,0,0,0.4),
            inset 0 2px 0 rgba(255,255,255,0.6);
    }
}

.btn-start-3d:hover {
    transform: perspective(500px) rotateX(0deg) translateY(-5px) scale(1.05);
    animation: none;
    box-shadow:
        0 0 60px rgba(255, 215, 0, 1),
        0 0 100px rgba(255, 165, 0, 0.8),
        0 25px 50px rgba(255, 165, 0, 0.6),
        0 10px 25px rgba(0,0,0,0.4);
}

.btn-start-3d:active {
    transform: perspective(500px) rotateX(5deg) translateY(0) scale(0.98);
    animation: none;
}

.btn-content {
    position: relative;
    z-index: 2;
    display: flex;
    align-items: center;
    gap: 12px;
}

.btn-icon-left, .btn-icon-right {
    font-size: 1.3rem;
    animation: btnIconPop 1s ease-in-out infinite;
}

.btn-icon-right {
    animation-delay: 0.5s;
}

@keyframes btnIconPop {
    0%, 100% { transform: scale(1) rotate(0deg); }
    50% { transform: scale(1.3) rotate(15deg); }
}

.btn-layer {
    position: absolute;
    inset: 0;
    border-radius: 50px;
}

.btn-layer-1 {
    background: var(--gradient-gold);
    transform: translateZ(-5px);
    filter: brightness(0.8);
}

.btn-layer-2 {
    background: var(--gold-dark);
    transform: translateZ(-10px);
    filter: brightness(0.6);
}

.btn-shine-3d {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
    animation: btnShine3d 2s ease-in-out infinite;
    z-index: 3;
}

@keyframes btnShine3d {
    0%, 100% { left: -100%; }
    50% { left: 100%; }
}

/* éŸ³æ•ˆå¼€å…³ */
.sound-toggle {
    margin: 10px 0;
}

.sound-btn {
    background: rgba(0,0,0,0.4);
    border: 2px solid rgba(255, 215, 0, 0.5);
    padding: 10px 20px;
    border-radius: 25px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    transition: all var(--transition-fast);
}

.sound-btn:hover {
    background: rgba(255, 215, 0, 0.2);
    border-color: var(--gold-primary);
}

.sound-on, .sound-off {
    font-size: 1.2rem;
}

.sound-btn.active .sound-off { display: none; }
.sound-btn:not(.active) .sound-on { display: none; }

.sound-label {
    color: var(--gold-light);
    font-size: 0.85rem;
}

/* æ“ä½œæç¤º */
.control-hints-3d {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.85rem;
    margin-top: 10px;
}

.hint-card {
    display: flex;
    align-items: center;
    gap: 6px;
    background: rgba(0,0,0,0.3);
    padding: 8px 15px;
    border-radius: 20px;
}

.hint-icon {
    font-size: 1rem;
}

.hint-divider {
    opacity: 0.5;
}

/* 3Dæ³¢æµª */
.wave-3d-container {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 120px;
    overflow: hidden;
    perspective: 500px;
}

.wave-3d {
    position: absolute;
    bottom: 0;
    left: -50%;
    width: 200%;
    height: 100%;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 100'%3E%3Cpath fill='rgba(139,0,0,0.3)' d='M0,50 C360,100 1080,0 1440,50 L1440,100 L0,100 Z'/%3E%3C/svg%3E");
    background-size: 50% 100%;
    animation: waveMove3d 8s linear infinite;
}

.wave-1 { animation-duration: 8s; opacity: 0.7; }
.wave-2 { animation-duration: 10s; animation-delay: -2s; opacity: 0.5; bottom: 10px; }
.wave-3 { animation-duration: 12s; animation-delay: -4s; opacity: 0.3; bottom: 20px; }

@keyframes waveMove3d {
    0% { transform: translateX(0) rotateX(10deg); }
    100% { transform: translateX(-50%) rotateX(10deg); }
}

/* åº•éƒ¨å­¦é™¢æ ‡è¯† */
.footer-college {
    position: absolute;
    bottom: 15px;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    color: var(--gold-light);
    font-size: 0.8rem;
    opacity: 0.8;
    z-index: 20;
}

.footer-line {
    width: 50px;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--gold-primary), transparent);
}

/* ==================== æ¸¸æˆé¡µé¢3D ==================== */
#game-screen {
    background: var(--gradient-night);
    display: flex !important;
    justify-content: center;
    align-items: center;
    /* ç¡®ä¿å­å…ƒç´ ï¼ˆæç¤ºã€ç‰¹æ•ˆç­‰ï¼‰ä¸è¢«è£å‰ª */
    overflow: visible;
}

#game-canvas {
    display: block;
    max-width: 100%;
}

/* ğŸ“± ç§»åŠ¨ç«¯æ¸¸æˆç”»å¸ƒé€‚é… */
@media (max-width: 768px) {
    #game-screen {
        background: var(--gradient-night);
        overflow: visible;
    }

    #game-canvas {
        max-width: 420px;
        width: 100%;
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    }
}

/* 3D HUD */
.game-hud-3d {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 15px 20px;
    z-index: 100;
    background: linear-gradient(180deg, rgba(0,0,0,0.7) 0%, transparent 100%);
    pointer-events: none;
}

/* ğŸ“± ç§»åŠ¨ç«¯HUDé€‚é…ç”»å¸ƒå®½åº¦ */
@media (max-width: 768px) {
    .game-hud-3d {
        left: max(0px, calc((100vw - 420px) / 2));
        right: max(0px, calc((100vw - 420px) / 2));
        max-width: 420px;
        margin: 0 auto;
        padding: 10px 15px;
    }
}

.hud-left-3d, .hud-right-3d {
    display: flex;
    flex-direction: column;
    gap: 10px;
    pointer-events: auto;
}

.hud-center-3d {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 15px;
    pointer-events: auto;
}

/* åˆ†æ•°é¢æ¿3D */
.score-panel-3d {
    position: relative;
    background: linear-gradient(135deg, rgba(0,0,0,0.7), rgba(30,0,50,0.8));
    padding: 12px 20px;
    border-radius: 20px;
    border: 2px solid var(--gold-primary);
    min-width: 120px;
    transform: perspective(300px) rotateY(-5deg);
    transition: transform var(--transition-fast);
}

.score-panel-3d:hover {
    transform: perspective(300px) rotateY(0deg);
}

.score-content {
    display: flex;
    align-items: center;
    gap: 10px;
    position: relative;
    z-index: 2;
}

.score-icon {
    font-size: 1.5rem;
    animation: scoreIconBounce 1s ease-in-out infinite;
}

@keyframes scoreIconBounce {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.score-label {
    font-size: 0.7rem;
    color: var(--gold-light);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.score-value-3d {
    font-size: 2rem;
    font-weight: bold;
    color: var(--gold-primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
    transition: transform 0.1s;
}

.score-value-3d.bump {
    animation: scoreBump 0.2s ease-out;
}

@keyframes scoreBump {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
}

.panel-glow {
    position: absolute;
    inset: -3px;
    border-radius: 23px;
    background: var(--gold-primary);
    filter: blur(10px);
    opacity: 0.3;
    z-index: 0;
}

/* è¿å‡»æ˜¾ç¤º3D */
.combo-display-3d {
    display: flex;
    align-items: center;
    gap: 8px;
    background: linear-gradient(135deg, #FF6B00, #FF4500);
    padding: 10px 18px;
    border-radius: 25px;
    animation: comboPulse3d 0.5s ease-in-out infinite;
    box-shadow: 0 0 30px rgba(255, 100, 0, 0.6);
}

@keyframes comboPulse3d {
    0%, 100% { transform: scale(1) rotate(-2deg); }
    50% { transform: scale(1.1) rotate(2deg); }
}

.combo-fire {
    font-size: 1.5rem;
    animation: fireFlicker 0.2s ease-in-out infinite alternate;
}

.combo-count {
    font-size: 1.5rem;
    font-weight: bold;
    color: #FFF;
    text-shadow: 0 0 10px rgba(255,255,255,0.5);
}

.combo-label {
    font-size: 0.7rem;
    color: rgba(255,255,255,0.8);
}

.combo-glow {
    position: absolute;
    inset: -5px;
    border-radius: 30px;
    background: #FF6B00;
    filter: blur(15px);
    opacity: 0.5;
    z-index: -1;
}

/* æ³¢æ•°æ ‡è¯†3D */
.level-badge-3d {
    position: relative;
    background: var(--gradient-gold);
    padding: 10px 30px;
    border-radius: 30px;
    box-shadow: var(--glow-gold);
    transform: perspective(300px) rotateX(5deg);
    transition: all var(--transition-normal);
}

.level-badge-3d.level-up {
    animation: levelUp3d 0.5s ease-out;
}

@keyframes levelUp3d {
    0% { transform: perspective(300px) rotateX(5deg) scale(1); }
    50% { transform: perspective(300px) rotateX(0deg) scale(1.3); }
    100% { transform: perspective(300px) rotateX(5deg) scale(1); }
}

.level-inner {
    display: flex;
    align-items: baseline;
    gap: 5px;
}

.level-prefix, .level-suffix {
    font-size: 0.9rem;
    color: var(--red-dark);
    font-weight: bold;
}

.level-num {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--red-dark);
}

.level-glow {
    position: absolute;
    inset: -5px;
    border-radius: 35px;
    background: var(--gold-primary);
    filter: blur(15px);
    opacity: 0.4;
    z-index: -1;
}

/* æ—¶é—´é¢æ¿3D */
.time-panel-3d {
    display: flex;
    justify-content: flex-end;
}

.time-ring-3d {
    position: relative;
    width: 85px;
    height: 85px;
    transform: perspective(300px) rotateY(5deg);
    transition: transform var(--transition-fast);
}

.time-ring-3d:hover {
    transform: perspective(300px) rotateY(0deg);
}

.time-ring-3d svg {
    transform: rotate(-90deg);
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5));
}

.time-bg {
    fill: none;
    stroke: rgba(255,255,255,0.15);
    stroke-width: 8;
}

.time-fill {
    fill: none;
    stroke: url(#timeGradient);
    stroke-width: 8;
    stroke-linecap: round;
    stroke-dasharray: 264;
    stroke-dashoffset: 0;
    transition: stroke-dashoffset 1s linear, stroke 0.3s;
}

.time-fill.warning {
    stroke: #FF6B00;
}

.time-fill.danger {
    stroke: #FF0000;
    animation: timeDanger 0.5s ease-in-out infinite;
}

@keyframes timeDanger {
    0%, 100% { stroke-width: 8; filter: drop-shadow(0 0 10px #FF0000); }
    50% { stroke-width: 12; filter: drop-shadow(0 0 20px #FF0000); }
}

.time-inner {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.time-value-3d {
    display: block;
    font-size: 1.8rem;
    font-weight: bold;
    color: #FFF;
    text-shadow: 0 0 15px rgba(255,255,255,0.5);
    line-height: 1;
}

.time-unit {
    font-size: 0.7rem;
    color: rgba(255,255,255,0.7);
}

.time-glow {
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.3) 0%, transparent 70%);
    animation: timeGlow 2s ease-in-out infinite;
}

@keyframes timeGlow {
    0%, 100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 0.6; transform: scale(1.1); }
}

/* æŠ€èƒ½æ 3D */
.skill-bar-3d {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 20px;
    z-index: 200; /* æ¯”è§¦æ‘¸åŒºåŸŸæ›´é«˜ */
    perspective: 500px;
    pointer-events: auto; /* ç¡®ä¿å¯ç‚¹å‡» */
}

.skill-btn-3d {
    position: relative;
    width: 70px;
    height: 70px;
    border-radius: 50%;
    border: 3px solid rgba(255, 215, 0, 0.5);
    background: linear-gradient(145deg, rgba(0,0,0,0.7), rgba(30,0,50,0.8));
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
    transform: perspective(200px) rotateX(10deg);
    pointer-events: auto; /* ğŸ“± ç¡®ä¿ç§»åŠ¨ç«¯å¯ç‚¹å‡» */
    -webkit-tap-highlight-color: rgba(255, 215, 0, 0.3);
    touch-action: manipulation;
}

.skill-btn-3d:not(:disabled):hover {
    transform: perspective(200px) rotateX(0deg) scale(1.1);
    border-color: var(--gold-primary);
    background: linear-gradient(145deg, rgba(255, 215, 0, 0.3), rgba(30,0,50,0.8));
}

.skill-btn-3d:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.skill-btn-3d.ready {
    border-color: #4CAF50;
    animation: skillReady3d 1s ease-in-out infinite;
}

@keyframes skillReady3d {
    0%, 100% {
        box-shadow: 0 0 20px rgba(76, 175, 80, 0.6);
        transform: perspective(200px) rotateX(10deg) scale(1);
    }
    50% {
        box-shadow: 0 0 40px rgba(76, 175, 80, 0.9);
        transform: perspective(200px) rotateX(5deg) scale(1.05);
    }
}

.skill-icon-3d {
    font-size: 1.8rem;
    margin-bottom: 2px;
}

.skill-name {
    font-size: 0.6rem;
    color: var(--gold-light);
}

.skill-key {
    position: absolute;
    top: -5px;
    right: -5px;
    width: 22px;
    height: 22px;
    background: var(--gold-primary);
    color: var(--red-dark);
    font-size: 0.7rem;
    font-weight: bold;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.skill-charge-ring {
    position: absolute;
    inset: -3px;
    pointer-events: none;
}

.skill-charge-ring svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.charge-bg {
    fill: none;
    stroke: rgba(255,255,255,0.1);
    stroke-width: 4;
}

.charge-fill {
    fill: none;
    stroke: #4CAF50;
    stroke-width: 4;
    stroke-linecap: round;
    stroke-dasharray: 163;
    stroke-dashoffset: 163;
    transition: stroke-dashoffset 0.3s;
}

.skill-glow {
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.3) 0%, transparent 70%);
    opacity: 0;
    transition: opacity var(--transition-fast);
}

.skill-btn-3d.ready .skill-glow {
    opacity: 1;
    animation: skillGlow 1s ease-in-out infinite;
}

@keyframes skillGlow {
    0%, 100% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.2); opacity: 0.8; }
}

/* BuffçŠ¶æ€æ 3D */
.status-bar-3d {
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 12px;
    z-index: 100;
}

.buff-item-3d {
    background: linear-gradient(135deg, rgba(0,0,0,0.8), rgba(30,0,50,0.9));
    padding: 8px 18px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    gap: 10px;
    animation: buffAppear3d 0.4s ease-out;
    position: relative;
    overflow: hidden;
    border: 2px solid;
}

#buff-invincible { border-color: #4CAF50; }
#buff-double { border-color: #9C27B0; }
#buff-magnet { border-color: #2196F3; }
#buff-slow { border-color: #FF9800; }
#buff-fever { border-color: #FFD700; }

@keyframes buffAppear3d {
    0% { transform: scale(0) rotateX(90deg); opacity: 0; }
    100% { transform: scale(1) rotateX(0deg); opacity: 1; }
}

.buff-icon {
    font-size: 1.3rem;
}

.buff-text {
    font-size: 0.85rem;
    color: #FFF;
    font-weight: bold;
}

.buff-timer-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: rgba(255,255,255,0.2);
}

.buff-timer-fill {
    height: 100%;
    background: var(--gold-primary);
    width: 100%;
    transition: width 0.1s linear;
}

/* ğŸ“± è§¦æ§åŒºåŸŸ - ç§»åŠ¨ç«¯ä¼˜åŒ– */
.touch-zone {
    position: fixed;
    top: 0;
    bottom: 150px; /* åº•éƒ¨ç•™å‡ºç©ºé—´ç»™æŠ€èƒ½æ  */
    width: 50%;
    z-index: 50;
    /* é˜²æ­¢è§¦æ‘¸æ—¶é€‰ä¸­æ–‡å­— */
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
}

.touch-zone.left { left: 0; }
.touch-zone.right { right: 0; }

/* ğŸ“± ç§»åŠ¨ç«¯è§¦æ‘¸åŒºåŸŸé€‚é… */
@media (max-width: 768px) {
    .touch-zone {
        bottom: 130px; /* ç§»åŠ¨ç«¯åº•éƒ¨ç•™æ›´å¤šç©ºé—´ */
    }
}

@media (max-width: 480px) {
    .touch-zone {
        bottom: 120px;
    }
}

@media (max-width: 360px) {
    .touch-zone {
        bottom: 100px;
    }
}

.touch-indicator {
    position: absolute;
    bottom: 120px;
    width: 70px;
    height: 70px;
    background: rgba(255, 215, 0, 0.25);
    border: 3px solid rgba(255, 215, 0, 0.5);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    color: var(--gold-primary);
    opacity: 0.7;
    transition: all 0.15s ease;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    /* å‘¼å¸åŠ¨ç”»æç¤ºå¯ç‚¹å‡» */
    animation: touchPulse 2s ease-in-out infinite;
}

@keyframes touchPulse {
    0%, 100% { transform: scale(1); opacity: 0.7; }
    50% { transform: scale(1.05); opacity: 0.9; }
}

.touch-zone.left .touch-indicator { left: 25px; }
.touch-zone.right .touch-indicator { right: 25px; }

.touch-zone:active .touch-indicator {
    opacity: 1;
    transform: scale(0.85);
    background: rgba(255, 215, 0, 0.5);
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
    animation: none;
}

/* è§¦æ‘¸æç¤ºæ–‡å­— */
.touch-zone::after {
    content: '';
    position: absolute;
    bottom: 85px;
    font-size: 0.7rem;
    color: rgba(255, 215, 0, 0.5);
    white-space: nowrap;
}

.touch-zone.left::after {
    content: 'â† å·¦ç§»';
    left: 30px;
}

.touch-zone.right::after {
    content: 'å³ç§» â†’';
    right: 30px;
}

/* æ¡Œé¢ç«¯éšè—è§¦æ‘¸åŒºåŸŸ */
@media (hover: hover) and (pointer: fine) {
    .touch-zone { display: none; }
    .skill-bar-3d { bottom: 30px; }
}

/* ç§»åŠ¨ç«¯é¢å¤–ä¼˜åŒ– */
@media (max-width: 768px) {
    .touch-indicator {
        width: 65px;
        height: 65px;
        font-size: 1.6rem;
        bottom: 100px;
    }

    .touch-zone.left .touch-indicator { left: 20px; }
    .touch-zone.right .touch-indicator { right: 20px; }

    .touch-zone::after {
        bottom: 70px;
    }
}

/* æ¨ªå±æ¨¡å¼ä¼˜åŒ– */
@media (max-height: 500px) and (orientation: landscape) {
    .touch-indicator {
        width: 50px;
        height: 50px;
        font-size: 1.2rem;
        bottom: 60px;
    }

    .touch-zone::after {
        display: none;
    }
}

/* å¾—åˆ†é£˜å­—3D */
.popup-container-3d {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 200;
    perspective: 500px;
}

.score-popup-3d {
    position: absolute;
    font-weight: bold;
    animation: popup3d 1s ease-out forwards;
    text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
    transform-style: preserve-3d;
}

.score-popup-3d.positive {
    color: #4CAF50;
    font-size: 1.8rem;
}

.score-popup-3d.negative {
    color: #F44336;
    font-size: 1.5rem;
}

.score-popup-3d.bonus {
    color: var(--gold-primary);
    font-size: 2.5rem;
    text-shadow: 0 0 30px var(--gold-primary);
}

.score-popup-3d.combo {
    color: #FF6B00;
    font-size: 2.2rem;
}

@keyframes popup3d {
    0% {
        opacity: 1;
        transform: translateY(0) translateZ(0) scale(1) rotateX(0deg);
    }
    50% {
        transform: translateY(-50px) translateZ(30px) scale(1.3) rotateX(-10deg);
    }
    100% {
        opacity: 0;
        transform: translateY(-100px) translateZ(0) scale(0.8) rotateX(10deg);
    }
}

/* æˆå°±æç¤º3D */
.achievement-toast-3d {
    position: fixed;
    top: 160px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 300;
}

.achievement-content {
    display: flex;
    align-items: center;
    gap: 15px;
    background: linear-gradient(135deg, var(--gold-primary), var(--gold-dark));
    padding: 15px 30px;
    border-radius: 40px;
    box-shadow: var(--shadow-3d), var(--glow-gold);
    animation: achievementSlide3d 0.5s ease-out;
}

@keyframes achievementSlide3d {
    0% { transform: translateY(-50px) rotateX(90deg); opacity: 0; }
    100% { transform: translateY(0) rotateX(0deg); opacity: 1; }
}

.achievement-icon {
    font-size: 2rem;
    animation: trophyBounce 1s ease-in-out infinite;
}

.achievement-info {
    text-align: left;
}

.achievement-title {
    display: block;
    font-size: 0.8rem;
    color: var(--red-dark);
    opacity: 0.8;
}

.achievement-name {
    display: block;
    font-size: 1.1rem;
    font-weight: bold;
    color: var(--red-dark);
}

.achievement-glow {
    position: absolute;
    inset: -10px;
    border-radius: 50px;
    background: var(--gold-primary);
    filter: blur(20px);
    opacity: 0.5;
    z-index: -1;
}

/* äº‹ä»¶æ¨ªå¹… */
.event-banner {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 250;
}

.event-content {
    display: flex;
    align-items: center;
    gap: 15px;
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.9), rgba(255, 165, 0, 0.9));
    padding: 20px 40px;
    border-radius: 20px;
    box-shadow: var(--shadow-3d);
    animation: eventPop 0.5s ease-out;
}

@keyframes eventPop {
    0% { transform: scale(0); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

.event-icon {
    font-size: 2rem;
    animation: iconPop 0.5s ease-in-out infinite;
}

@keyframes iconPop {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.3); }
}

.event-text {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--red-dark);
}

/* æš‚åœæŒ‰é’®3D */
.pause-btn-3d {
    position: fixed;
    top: 20px;
    right: 110px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.3);
    background: rgba(0,0,0,0.5);
    cursor: pointer;
    z-index: 100;
    transition: all var(--transition-fast);
    /* ç§»é™¤ rotateY é¿å…å›¾æ ‡è¢«è£å‰ª */
    transform: none;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: visible;
}

.pause-btn-3d:hover {
    transform: scale(1.1);
    background: rgba(255,255,255,0.2);
    border-color: var(--gold-primary);
}

.pause-icon {
    font-size: 1.5rem;
    line-height: 1;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* æš‚åœèœå•3D */
.pause-menu-3d {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.85);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 500;
    perspective: 800px;
    animation: fadeIn3d 0.3s ease;
}

@keyframes fadeIn3d {
    0% { opacity: 0; }
    100% { opacity: 1; }
}

.pause-card-3d {
    background: linear-gradient(145deg, var(--red-dark), var(--red-primary));
    padding: 40px 50px;
    border-radius: 30px;
    border: 3px solid var(--gold-primary);
    box-shadow: var(--shadow-3d), var(--glow-gold);
    text-align: center;
    transform: rotateX(5deg);
    animation: pauseCardAppear 0.4s ease-out;
}

@keyframes pauseCardAppear {
    0% { transform: rotateX(90deg) scale(0.5); opacity: 0; }
    100% { transform: rotateX(5deg) scale(1); opacity: 1; }
}

.pause-header {
    margin-bottom: 25px;
}

.pause-icon-large {
    font-size: 3rem;
    display: block;
    margin-bottom: 10px;
}

.pause-header h2 {
    color: var(--gold-primary);
    font-size: 2rem;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
}

.pause-stats {
    margin-bottom: 25px;
}

.stat-mini {
    color: var(--gold-light);
    font-size: 1rem;
    margin: 8px 0;
}

.stat-mini span {
    color: var(--gold-primary);
    font-weight: bold;
}

.pause-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.menu-btn-3d {
    padding: 15px 40px;
    border: none;
    border-radius: 30px;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.menu-btn-3d.primary {
    background: var(--gradient-gold);
    color: var(--red-dark);
}

.menu-btn-3d.secondary {
    background: rgba(255,255,255,0.1);
    color: #FFF;
    border: 2px solid rgba(255,255,255,0.3);
}

.menu-btn-3d:hover {
    transform: translateY(-3px) scale(1.02);
}

/* ==================== ç»“æŸé¡µé¢3D ==================== */
#end-screen {
    background: var(--gradient-festive);
    /* ğŸ“± å…è®¸é¡µé¢æ»šåŠ¨ - è¦†ç›–.screençš„å±…ä¸­å¸ƒå±€ */
    display: block !important;
    overflow-y: auto !important;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y;
    overscroll-behavior: contain;
}

.celebration-overlay {
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at center, transparent 0%, rgba(0,0,0,0.3) 100%);
    pointer-events: none;
}

/* ç»“æœå¡ç‰‡3D */
.result-card-3d {
    background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
    backdrop-filter: blur(15px);
    border-radius: 35px;
    overflow: hidden;
    border: 3px solid var(--gold-primary);
    box-shadow: var(--shadow-3d), var(--glow-gold);
    animation: resultCardAppear3d 0.6s ease-out;
    max-width: 420px;
    width: 95%;
}

@keyframes resultCardAppear3d {
    0% { transform: scale(0.5) rotateY(90deg); opacity: 0; }
    100% { transform: scale(1) rotateY(0deg); opacity: 1; }
}

/* ç»“æœå½©å¸¦3D */
.result-ribbon-3d {
    position: relative;
    background: var(--gradient-gold);
    padding: 18px;
    text-align: center;
}

.ribbon-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
}

.ribbon-content span:first-child,
.ribbon-content span:last-child {
    font-size: 1.5rem;
    animation: iconPop 1s ease-in-out infinite;
}

.ribbon-text {
    color: var(--red-dark);
    font-size: 1.5rem;
    font-weight: bold;
}

.ribbon-wing {
    position: absolute;
    bottom: -15px;
    width: 30px;
    height: 30px;
    background: var(--gold-dark);
}

.ribbon-wing.left {
    left: 0;
    clip-path: polygon(0 0, 100% 0, 100% 100%);
}

.ribbon-wing.right {
    right: 0;
    clip-path: polygon(0 0, 100% 0, 0 100%);
}

.result-body-3d {
    padding: 25px 20px;
}

/* åˆ†æ•°å±•ç¤º3D */
.score-showcase-3d {
    margin-bottom: 25px;
    perspective: 500px;
}

.score-orb {
    position: relative;
    width: 160px;
    height: 160px;
    margin: 0 auto;
    transform-style: preserve-3d;
    animation: orbFloat 3s ease-in-out infinite;
}

@keyframes orbFloat {
    0%, 100% { transform: translateY(0) rotateY(0deg); }
    50% { transform: translateY(-10px) rotateY(10deg); }
}

.orb-ring {
    position: absolute;
    inset: 0;
    border: 2px solid var(--gold-primary);
    border-radius: 50%;
    opacity: 0.5;
}

.ring-1 { animation: ringRotate 8s linear infinite; }
.ring-2 { animation: ringRotate 6s linear infinite reverse; transform: rotateX(60deg); }
.ring-3 { animation: ringRotate 10s linear infinite; transform: rotateY(60deg); }

@keyframes ringRotate {
    0% { transform: rotateZ(0deg); }
    100% { transform: rotateZ(360deg); }
}

.orb-core {
    position: absolute;
    inset: 15px;
    background: linear-gradient(145deg, var(--red-dark), var(--red-primary));
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border: 3px solid var(--gold-primary);
    box-shadow:
        inset 0 0 30px rgba(0,0,0,0.3),
        0 0 30px rgba(255, 215, 0, 0.4);
}

.orb-core .score-label {
    font-size: 0.75rem;
    color: var(--gold-light);
    margin-bottom: 3px;
}

.final-score-3d {
    font-size: 2.5rem;
    font-weight: bold;
    color: var(--gold-primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
    line-height: 1;
}

.score-rank {
    font-size: 1.2rem;
    font-weight: bold;
    color: var(--gold-light);
    margin-top: 3px;
}

.new-record-3d {
    margin-top: 15px;
    animation: recordPulse3d 0.5s ease-out infinite alternate;
}

@keyframes recordPulse3d {
    0% { transform: scale(1); }
    100% { transform: scale(1.1); }
}

.record-icon {
    font-size: 1.2rem;
}

.record-text {
    background: linear-gradient(135deg, #4CAF50, #8BC34A);
    color: #FFF;
    padding: 8px 25px;
    border-radius: 25px;
    font-weight: bold;
    margin: 0 10px;
}

/* ç»Ÿè®¡é¢æ¿3D */
.stats-panel-3d {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-bottom: 20px;
}

.stat-card-3d {
    background: rgba(0,0,0,0.4);
    padding: 15px;
    border-radius: 18px;
    display: flex;
    align-items: center;
    gap: 12px;
    transform: perspective(200px) rotateX(5deg);
    transition: transform var(--transition-fast);
}

.stat-card-3d:hover {
    transform: perspective(200px) rotateX(0deg) scale(1.02);
}

.stat-icon {
    font-size: 1.8rem;
}

.stat-info {
    text-align: left;
}

.stat-label {
    display: block;
    font-size: 0.7rem;
    color: rgba(255,255,255,0.7);
}

.stat-value {
    display: block;
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--gold-primary);
}

/* ç¥ç¦å¡ç‰‡3D */
.blessing-card-3d {
    position: relative;
    background: rgba(255, 215, 0, 0.1);
    padding: 20px;
    border-radius: 18px;
    margin-bottom: 20px;
}

.blessing-border {
    position: absolute;
    inset: 0;
    border: 2px dashed rgba(255, 215, 0, 0.4);
    border-radius: 18px;
    animation: borderDash 20s linear infinite;
}

@keyframes borderDash {
    0% { stroke-dashoffset: 0; }
    100% { stroke-dashoffset: 1000; }
}

.blessing-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.blessing-deco {
    font-size: 1.5rem;
    animation: sparkle3d 1s ease-in-out infinite;
}

@keyframes sparkle3d {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
    50% { transform: scale(1.3) rotate(180deg); opacity: 0.7; }
}

.blessing-text-3d {
    font-size: 1.1rem;
    color: #FFF;
    line-height: 1.6;
}

/* å­¦é™¢ç¥ç¦ */
.college-blessing {
    text-align: center;
    padding: 15px;
    background: rgba(0,0,0,0.3);
    border-radius: 15px;
    margin-bottom: 15px;
}

.college-logo-small {
    font-size: 2rem;
    margin-bottom: 8px;
}

.college-blessing p {
    color: var(--gold-light);
    font-size: 0.85rem;
    margin: 3px 0;
}

.college-wish {
    color: var(--gold-primary) !important;
    font-weight: bold;
    margin-top: 8px !important;
}

/* ç»“æœæŒ‰é’®3D */
.result-buttons-3d {
    display: flex;
    gap: 15px;
    padding: 0 20px 25px;
}

.result-btn-3d {
    flex: 1;
    padding: 15px 20px;
    border: none;
    border-radius: 30px;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all var(--transition-fast);
    transform: perspective(200px) rotateX(5deg);
}

.result-btn-3d:hover {
    transform: perspective(200px) rotateX(0deg) translateY(-3px);
}

.result-btn-3d.primary {
    background: var(--gradient-gold);
    color: var(--red-dark);
}

.result-btn-3d.secondary {
    background: rgba(255,255,255,0.15);
    color: #FFF;
    border: 2px solid rgba(255,255,255,0.3);
}

.btn-icon {
    font-size: 1.2rem;
}

/* åº•éƒ¨è£…é¥° */
.footer-decoration {
    margin-top: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    color: var(--gold-light);
    font-size: 0.9rem;
    opacity: 0.9;
}

/* ==================== å“åº”å¼ ==================== */

/* ğŸ“± ç§»åŠ¨ç«¯æ¸¸æˆé¡µé¢ä¼˜åŒ– */
@media (max-width: 768px) {
    /* HUDæ•´ä½“ç¼©å° */
    .game-hud-3d {
        padding: 10px 12px;
        padding-top: max(10px, env(safe-area-inset-top));
    }

    /* åˆ†æ•°é¢æ¿ç¼©å° */
    .score-panel-3d {
        padding: 8px 12px;
        min-width: 90px;
        border-radius: 15px;
        transform: none;
    }

    .score-icon {
        font-size: 1.2rem;
    }

    .score-value-3d {
        font-size: 1.4rem;
    }

    .score-label {
        font-size: 0.6rem;
    }

    /* è¿å‡»æ˜¾ç¤ºç¼©å° */
    .combo-display-3d {
        padding: 6px 12px;
        border-radius: 15px;
    }

    .combo-fire {
        font-size: 1.1rem;
    }

    .combo-count {
        font-size: 1.1rem;
    }

    /* æ³¢æ•°æ ‡è¯†ç¼©å° */
    .level-badge-3d {
        padding: 6px 14px;
        border-radius: 20px;
    }

    .level-num {
        font-size: 1.3rem;
    }

    .level-prefix, .level-suffix {
        font-size: 0.65rem;
    }

    /* æ—¶é—´é¢æ¿ç¼©å° */
    .time-panel-3d {
        transform: none;
    }

    .time-ring-3d {
        width: 60px;
        height: 60px;
    }

    .time-value-3d {
        font-size: 1.3rem;
    }

    .time-unit {
        font-size: 0.5rem;
    }

    /* æŠ€èƒ½æ ä¼˜åŒ– */
    .skill-bar-3d {
        bottom: 90px;
        gap: 12px;
        padding: 8px 15px;
    }

    .skill-btn-3d {
        width: 55px;
        height: 55px;
    }

    .skill-icon-3d {
        font-size: 1.4rem;
    }

    .skill-name {
        font-size: 0.55rem;
    }

    .skill-key {
        display: none;
    }

    /* BuffçŠ¶æ€æ  */
    .status-bar-3d {
        top: auto;
        bottom: 160px;
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        flex-direction: row;
    }

    .buff-item-3d {
        padding: 4px 10px;
        font-size: 0.7rem;
    }

    /* è§¦æ‘¸åŒºåŸŸä¼˜åŒ– */
    .touch-indicator {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
        bottom: 180px;
        opacity: 0.6;
    }

    .touch-zone.left .touch-indicator { left: 15px; }
    .touch-zone.right .touch-indicator { right: 15px; }

    .touch-zone::after {
        bottom: 150px;
        font-size: 0.65rem;
    }
}

/* æ›´å°å±å¹•ä¼˜åŒ– */
@media (max-width: 420px) {
    .title-char-3d {
        font-size: 3rem;
    }

    .item-row {
        grid-template-columns: repeat(2, 1fr);
    }

    /* æ¸¸æˆHUDè¿›ä¸€æ­¥ç¼©å° */
    .game-hud-3d {
        padding: 8px 10px;
    }

    .score-panel-3d {
        padding: 6px 10px;
        min-width: 80px;
    }

    .score-value-3d {
        font-size: 1.2rem;
    }

    .time-ring-3d {
        width: 50px;
        height: 50px;
    }

    .time-value-3d {
        font-size: 1.1rem;
    }

    .level-badge-3d {
        padding: 4px 10px;
    }

    .level-num {
        font-size: 1.1rem;
    }

    .skill-bar-3d {
        bottom: 80px;
        gap: 10px;
        padding: 6px 12px;
    }

    .skill-btn-3d {
        width: 50px;
        height: 50px;
    }

    .skill-icon-3d {
        font-size: 1.2rem;
    }

    .touch-indicator {
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
        bottom: 150px;
    }

    .touch-zone::after {
        bottom: 120px;
    }

    .score-orb {
        width: 130px;
        height: 130px;
    }

    .final-score-3d {
        font-size: 2rem;
    }

    .stats-panel-3d {
        grid-template-columns: 1fr 1fr;
    }
}

/* è¶…å°å±å¹• */
@media (max-width: 360px) {
    .game-hud-3d {
        padding: 6px 8px;
    }

    .score-panel-3d {
        padding: 5px 8px;
        min-width: 70px;
    }

    .score-icon {
        font-size: 1rem;
    }

    .score-value-3d {
        font-size: 1rem;
    }

    .time-ring-3d {
        width: 45px;
        height: 45px;
    }

    .level-badge-3d {
        display: none;
    }

    .skill-bar-3d {
        bottom: 70px;
        gap: 8px;
    }

    .skill-btn-3d {
        width: 45px;
        height: 45px;
    }

    .touch-indicator {
        width: 45px;
        height: 45px;
        bottom: 130px;
    }
}

@media (max-height: 700px) {
    .snake-logo-3d {
        display: none;
    }

    .instruction-card-3d {
        margin: 10px 0;
    }

    .btn-start-3d {
        margin: 15px 0;
        padding: 15px 50px;
    }
}

/* ==================== é¢å¤–æ ·å¼è¡¥å…… ==================== */

/* é£˜è½ç¦å­—åŠ¨ç”» */
.floating-fu {
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
}

.fu-char {
    position: absolute;
    top: -80px;
    font-size: 2rem;
    color: rgba(255, 215, 0, 0.3);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    animation: floatDown 15s linear infinite;
    transform: rotate(0deg);
}

@keyframes floatDown {
    0% {
        top: -80px;
        opacity: 0;
        transform: rotate(0deg) translateX(0);
    }
    10% {
        opacity: 0.5;
    }
    90% {
        opacity: 0.5;
    }
    100% {
        top: 110%;
        opacity: 0;
        transform: rotate(360deg) translateX(50px);
    }
}

/* Buffè®¡æ—¶å™¨åŠ¨ç”» */
@keyframes buff-timer {
    0% { width: 100%; }
    100% { width: 0%; }
}

/* Feverå¾—åˆ†é£˜å­—æ ·å¼ */
.score-popup-3d.fever {
    color: #FF4500;
    font-size: 2.8rem;
    text-shadow:
        0 0 20px #FF4500,
        0 0 40px #FFD700,
        0 0 60px #FF6B00;
    animation: popupFever3d 1s ease-out forwards;
}

@keyframes popupFever3d {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1) rotateZ(0deg);
    }
    50% {
        opacity: 1;
        transform: translateY(-40px) scale(1.5) rotateZ(5deg);
    }
    100% {
        opacity: 0;
        transform: translateY(-80px) scale(0.8) rotateZ(-5deg);
    }
}

/* æ³¢æ•°å‡çº§åŠ¨ç”» */
.level-badge-3d.level-up {
    animation: levelUpPulse 0.5s ease-out;
}

@keyframes levelUpPulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 rgba(255, 215, 0, 0.8);
    }
    50% {
        transform: scale(1.3);
        box-shadow: 0 0 40px rgba(255, 215, 0, 0.8);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 rgba(255, 215, 0, 0);
    }
}

/* äº‹ä»¶æ¨ªå¹…æ˜¾ç¤ºåŠ¨ç”» */
.event-banner.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

/* æˆå°±æç¤ºæ˜¾ç¤ºåŠ¨ç”» */
.achievement-toast-3d.show {
    opacity: 1;
    transform: translateY(0);
}

/* æŠ€èƒ½æŒ‰é’®å°±ç»ªçŠ¶æ€ */
.skill-btn-3d.ready {
    box-shadow:
        0 0 20px rgba(255, 215, 0, 0.6),
        inset 0 0 20px rgba(255, 215, 0, 0.2);
    animation: skillReady 0.8s ease-in-out infinite alternate;
}

@keyframes skillReady {
    0% {
        box-shadow:
            0 0 15px rgba(255, 215, 0, 0.4),
            inset 0 0 15px rgba(255, 215, 0, 0.1);
    }
    100% {
        box-shadow:
            0 0 30px rgba(255, 215, 0, 0.8),
            inset 0 0 25px rgba(255, 215, 0, 0.3);
    }
}

/* æŠ€èƒ½å……èƒ½ç¯æ ·å¼ */
.skill-charge-ring .charge-bg {
    fill: none;
    stroke: rgba(255, 255, 255, 0.1);
    stroke-width: 4;
}

.skill-charge-ring .charge-fill {
    fill: none;
    stroke: var(--gold-primary);
    stroke-width: 4;
    stroke-linecap: round;
    transform: rotate(-90deg);
    transform-origin: center;
    transition: stroke-dashoffset 0.3s ease-out;
}

/* éŸ³æ•ˆæŒ‰é’®çŠ¶æ€ */
.sound-btn {
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid rgba(255, 215, 0, 0.3);
    border-radius: 25px;
    padding: 8px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: all var(--transition-fast);
    color: #FFF;
}

.sound-btn:hover {
    background: rgba(0, 0, 0, 0.5);
    border-color: var(--gold-primary);
}

.sound-btn .sound-on,
.sound-btn .sound-off {
    font-size: 1.2rem;
}

.sound-btn.active .sound-off {
    display: none;
}

.sound-btn:not(.active) .sound-on {
    display: none;
}

.sound-label {
    font-size: 0.8rem;
    color: var(--gold-light);
}

.sound-toggle {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 100;
}

/* æ—¶é—´è¿›åº¦æ¡é¢œè‰²å˜åŒ– */
.time-fill.warning {
    stroke: #FFA500 !important;
}

.time-fill.danger {
    stroke: #FF4444 !important;
    animation: timePulse 0.5s ease-in-out infinite alternate;
}

@keyframes timePulse {
    0% { stroke-opacity: 0.8; }
    100% { stroke-opacity: 1; }
}

/* æš‚åœèœå•ç»Ÿè®¡ */
.pause-stats {
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    margin-bottom: 20px;
}

.stat-mini {
    color: var(--gold-light);
    font-size: 0.9rem;
    margin: 5px 0;
}

.stat-mini span {
    color: var(--gold-primary);
    font-weight: bold;
}

/* ==================== ä¼ ç»Ÿæ–‡åŒ–ç¥ç¦æ ·å¼ ==================== */
.traditional-blessing {
    margin: 15px 0;
    perspective: 800px;
}

.blessing-scroll {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    background: linear-gradient(135deg, #8B0000 0%, #DC143C 50%, #8B0000 100%);
    padding: 20px 15px;
    border-radius: 10px;
    position: relative;
    transform: rotateX(5deg);
    box-shadow:
        0 10px 30px rgba(0, 0, 0, 0.4),
        inset 0 2px 0 rgba(255, 255, 255, 0.2),
        inset 0 -2px 0 rgba(0, 0, 0, 0.3);
    border: 3px solid var(--gold-primary);
}

.blessing-scroll::before,
.blessing-scroll::after {
    content: '';
    position: absolute;
    top: -8px;
    width: 20px;
    height: calc(100% + 16px);
    background: linear-gradient(180deg, #DAA520 0%, #FFD700 50%, #DAA520 100%);
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

.blessing-scroll::before { left: 15px; }
.blessing-scroll::after { right: 15px; }

.scroll-ornament {
    width: 45px;
    height: 45px;
    background: linear-gradient(145deg, #FFD700, #DAA520);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: var(--red-dark);
    font-weight: bold;
    box-shadow:
        0 4px 15px rgba(0, 0, 0, 0.3),
        inset 0 2px 0 rgba(255, 255, 255, 0.4);
    border: 2px solid #B8860B;
    text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.3);
    animation: ornamentPulse 2s ease-in-out infinite;
    z-index: 1;
}

@keyframes ornamentPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); box-shadow: 0 4px 20px rgba(255, 215, 0, 0.6); }
}

.scroll-content {
    text-align: center;
    flex: 1;
    padding: 0 10px;
}

.main-wish {
    font-size: 1.1rem;
    color: var(--gold-primary);
    font-weight: bold;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
    margin-bottom: 8px;
    letter-spacing: 2px;
}

.sub-wish {
    font-size: 0.85rem;
    color: var(--gold-light);
    letter-spacing: 3px;
    opacity: 0.9;
}

/* ç¥ç¦å¡ç‰‡è›‡å½¢è£…é¥°åŠ¨ç”» */
.blessing-card-3d .blessing-deco {
    font-size: 1.8rem;
    animation: snakeWiggle 2s ease-in-out infinite;
}

@keyframes snakeWiggle {
    0%, 100% { transform: rotate(-10deg) scale(1); }
    25% { transform: rotate(5deg) scale(1.1); }
    50% { transform: rotate(-5deg) scale(1); }
    75% { transform: rotate(10deg) scale(1.1); }
}

/* ==================== ğŸ ç›²ç›’ç³»ç»Ÿæ ·å¼ ==================== */
.lucky-box-section {
    margin: 20px 0;
    padding: 20px;
    background: linear-gradient(135deg, rgba(139, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.4) 100%);
    border-radius: 15px;
    border: 2px solid rgba(255, 215, 0, 0.3);
}

.lucky-box-title {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    font-size: 1.2rem;
    color: var(--gold-primary);
    margin-bottom: 15px;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

.lucky-box-container {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 160px;
    perspective: 1000px;
}

/* ç›²ç›’ä¸»ä½“ */
.lucky-box {
    --box-color: #FFD700;
    position: relative;
    width: 120px;
    height: 140px;
    cursor: pointer;
    transform-style: preserve-3d;
    transition: transform 0.3s ease;
}

.lucky-box:hover {
    transform: scale(1.05) rotateY(5deg);
}

.lucky-box:active {
    transform: scale(0.98);
}

/* ç›’ç›– */
.box-lid {
    position: absolute;
    top: 0;
    left: -5px;
    right: -5px;
    height: 35px;
    background: linear-gradient(180deg, var(--box-color) 0%, #B8860B 100%);
    border-radius: 8px 8px 0 0;
    border: 3px solid #8B6914;
    transform-origin: bottom center;
    transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    z-index: 2;
    display: flex;
    align-items: center;
    justify-content: center;
}

.lid-decoration {
    font-size: 1.5rem;
    color: #8B0000;
    font-weight: bold;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
}

/* ç›’èº« */
.box-body {
    position: absolute;
    top: 30px;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(180deg, #DC143C 0%, #8B0000 100%);
    border-radius: 0 0 10px 10px;
    border: 3px solid #5C0000;
    border-top: none;
    overflow: hidden;
}

.box-pattern {
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.2) 0%, transparent 30%),
        radial-gradient(circle at 80% 70%, rgba(255, 215, 0, 0.2) 0%, transparent 30%);
}

.box-glow {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, rgba(255, 215, 0, 0.3) 0%, transparent 70%);
    animation: boxGlow 2s ease-in-out infinite;
}

@keyframes boxGlow {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
}

.box-hint {
    position: absolute;
    bottom: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.8rem;
    color: var(--gold-light);
    animation: hintBounce 1s ease-in-out infinite;
}

@keyframes hintBounce {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(-5px); }
}

/* å¼€ç›’åŠ¨ç”» */
.lucky-box.opening .box-lid {
    animation: lidOpen 0.8s forwards;
}

@keyframes lidOpen {
    0% { transform: rotateX(0deg); }
    30% { transform: rotateX(-20deg); }
    100% { transform: rotateX(-120deg); }
}

.lucky-box.opening .box-glow {
    animation: glowBurst 0.8s forwards;
}

@keyframes glowBurst {
    0% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.5); }
    100% { opacity: 0; transform: scale(2); }
}

.lucky-box.opened {
    display: none;
}

/* å¥–åŠ±å±•ç¤º */
.box-reward {
    text-align: center;
    animation: rewardAppear 0.5s ease-out;
}

.box-reward.hidden {
    display: none;
}

@keyframes rewardAppear {
    0% {
        opacity: 0;
        transform: scale(0.5) translateY(20px);
    }
    50% {
        transform: scale(1.1) translateY(-10px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.reward-icon {
    font-size: 4rem;
    animation: rewardBounce 1s ease-in-out infinite;
    filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
}

@keyframes rewardBounce {
    0%, 100% { transform: scale(1) rotate(-5deg); }
    50% { transform: scale(1.1) rotate(5deg); }
}

.reward-title {
    font-size: 1.5rem;
    color: var(--gold-primary);
    font-weight: bold;
    margin: 10px 0 5px;
    text-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
}

.reward-desc {
    font-size: 1rem;
    color: #FFFFFF;
    margin: 5px 0;
}

.reward-blessing {
    font-size: 0.9rem;
    color: var(--gold-light);
    font-style: italic;
    margin-top: 10px;
    padding: 8px 15px;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 20px;
    display: inline-block;
}

.box-level-hint {
    margin-top: 15px;
    font-size: 0.85rem;
    text-align: center;
}

#box-level-text {
    color: var(--gold-primary);
    font-weight: bold;
}

/* ==================== ğŸ“± ç¤¾äº¤åˆ†äº«æ ·å¼ ==================== */
.social-section {
    margin: 20px 0;
    padding: 20px;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(139, 0, 0, 0.2) 100%);
    border-radius: 15px;
    border: 1px solid rgba(255, 215, 0, 0.2);
}

.social-title {
    font-size: 1rem;
    color: var(--gold-light);
    text-align: center;
    margin-bottom: 15px;
}

.social-buttons {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

.social-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    padding: 12px 20px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.85rem;
    min-width: 80px;
}

.social-btn .social-icon {
    font-size: 1.5rem;
}

.social-btn.poster {
    background: linear-gradient(135deg, #FF6B6B 0%, #DC143C 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(220, 20, 60, 0.4);
}

.social-btn.wechat {
    background: linear-gradient(135deg, #07C160 0%, #059a4a 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(7, 193, 96, 0.4);
}

.social-btn.link {
    background: linear-gradient(135deg, #4A90D9 0%, #2E5C99 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(74, 144, 217, 0.4);
}

.social-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
}

.social-btn:active {
    transform: translateY(0);
}

/* æ’è¡Œæ¦œé¢„è§ˆ */
.leaderboard-preview {
    margin-top: 20px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 12px;
    border: 1px solid rgba(255, 215, 0, 0.2);
}

.leaderboard-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 215, 0, 0.2);
}

.leaderboard-header span:first-child {
    font-size: 1.2rem;
}

.leaderboard-header span:nth-child(2) {
    color: var(--gold-primary);
    font-weight: bold;
    flex: 1;
    margin-left: 8px;
}

.view-more-btn {
    background: transparent;
    border: 1px solid var(--gold-primary);
    color: var(--gold-primary);
    padding: 5px 12px;
    border-radius: 15px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.view-more-btn:hover {
    background: var(--gold-primary);
    color: var(--red-dark);
}

.leaderboard-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.leaderboard-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    transition: all 0.3s ease;
}

.leaderboard-item:hover {
    background: rgba(255, 215, 0, 0.1);
}

.leaderboard-item .rank {
    font-size: 1.2rem;
    width: 35px;
    text-align: center;
}

.leaderboard-item .name {
    flex: 1;
    color: #FFFFFF;
    font-size: 0.9rem;
    margin-left: 10px;
}

.leaderboard-item .score {
    color: var(--gold-primary);
    font-weight: bold;
    font-size: 1rem;
}

.leaderboard-item.gold {
    background: linear-gradient(90deg, rgba(255, 215, 0, 0.2) 0%, transparent 100%);
}

.leaderboard-item.silver {
    background: linear-gradient(90deg, rgba(192, 192, 192, 0.2) 0%, transparent 100%);
}

.leaderboard-item.bronze {
    background: linear-gradient(90deg, rgba(205, 127, 50, 0.2) 0%, transparent 100%);
}

/* Toastæç¤º */
.share-toast {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: rgba(0, 0, 0, 0.85);
    color: #FFFFFF;
    padding: 12px 24px;
    border-radius: 25px;
    font-size: 0.9rem;
    opacity: 0;
    transition: all 0.3s ease;
    z-index: 9999;
    pointer-events: none;
    border: 1px solid var(--gold-primary);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}

.share-toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

/* å“åº”å¼é€‚é… */
@media (max-width: 480px) {
    .lucky-box {
        width: 100px;
        height: 120px;
    }

    .box-lid {
        height: 30px;
    }

    .lid-decoration {
        font-size: 1.2rem;
    }

    .reward-icon {
        font-size: 3rem;
    }

    .reward-title {
        font-size: 1.2rem;
    }

    .social-buttons {
        gap: 10px;
    }

    .social-btn {
        padding: 10px 15px;
        min-width: 70px;
        font-size: 0.75rem;
    }

    .social-btn .social-icon {
        font-size: 1.2rem;
    }

    .leaderboard-item .name {
        font-size: 0.8rem;
    }

    .leaderboard-item .score {
        font-size: 0.9rem;
    }
}

/* ==================== ğŸ® å…¨æ–°ç»“æŸé¡µé¢è®¾è®¡ ==================== */

/* é¡µé¢å®¹å™¨ */
.end-page-container {
    position: relative;
    z-index: 10;
    width: 100%;
    max-width: 420px;
    margin: 0 auto;
    padding: 20px 15px 40px 15px;
    min-height: auto;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

/* ===== ç¬¬ä¸€åŒºå—ï¼šæ ¸å¿ƒæˆç»© ===== */
.hero-section {
    text-align: center;
    padding: 15px 0;
}

.hero-title {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 20px;
}

.hero-title h1 {
    font-size: 1.5rem;
    color: var(--gold-primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    margin: 0;
    letter-spacing: 4px;
}

.title-deco {
    font-size: 1.8rem;
    animation: snakeWiggle 2s ease-in-out infinite;
}

/* åˆ†æ•°æ ¸å¿ƒå±•ç¤º */
.score-hero {
    position: relative;
    padding: 30px 20px;
    margin: 0 auto;
    max-width: 280px;
}

.score-glow-bg {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center,
        rgba(255, 215, 0, 0.15) 0%,
        rgba(220, 20, 60, 0.1) 50%,
        transparent 70%);
    border-radius: 50%;
    animation: pulseGlow 2s ease-in-out infinite;
}

@keyframes pulseGlow {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.1); opacity: 1; }
}

.score-content {
    position: relative;
    z-index: 1;
}

.score-label-mini {
    display: block;
    font-size: 0.85rem;
    color: var(--gold-light);
    margin-bottom: 8px;
    letter-spacing: 2px;
}

.score-number-wrap {
    margin: 10px 0;
}

.score-number {
    font-size: 4rem;
    font-weight: bold;
    color: var(--gold-primary);
    text-shadow:
        0 0 30px rgba(255, 215, 0, 0.8),
        0 4px 10px rgba(0, 0, 0, 0.3);
    line-height: 1;
    display: inline-block;
    animation: scoreAppear 0.8s ease-out;
}

@keyframes scoreAppear {
    0% { transform: scale(0.5); opacity: 0; }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); opacity: 1; }
}

.rank-badge {
    display: inline-block;
    padding: 6px 20px;
    background: linear-gradient(135deg, var(--gold-primary), #FFA500);
    color: var(--red-dark);
    font-size: 1.2rem;
    font-weight: bold;
    border-radius: 20px;
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
    margin-top: 10px;
}

.new-record-badge {
    margin-top: 15px;
    padding: 8px 20px;
    background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.2), transparent);
    color: #FFD700;
    font-size: 1rem;
    animation: recordFlash 1s ease-in-out infinite;
    border-radius: 20px;
}

.new-record-badge.hidden {
    display: none;
}

@keyframes recordFlash {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.05); }
}

/* ç»Ÿè®¡æ¡ */
.stats-bar {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px 20px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 25px;
    margin-top: 15px;
    border: 1px solid rgba(255, 215, 0, 0.2);
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 4px;
    color: #FFF;
    font-size: 0.9rem;
}

.stat-item .stat-icon {
    font-size: 1rem;
}

.stat-item .stat-num {
    color: var(--gold-primary);
    font-weight: bold;
}

.stat-divider {
    width: 1px;
    height: 16px;
    background: rgba(255, 215, 0, 0.3);
}

/* ===== ç¬¬äºŒåŒºå—ï¼šç¥ç¦è¯­ ===== */
.blessing-section {
    padding: 0 5px;
}

.blessing-card-new {
    position: relative;
    padding: 25px 20px;
    background: linear-gradient(135deg, rgba(139, 0, 0, 0.6) 0%, rgba(80, 0, 0, 0.8) 100%);
    border: 2px solid var(--gold-primary);
    border-radius: 12px;
    box-shadow:
        0 0 20px rgba(255, 215, 0, 0.2),
        inset 0 0 30px rgba(255, 215, 0, 0.05);
}

.blessing-corner {
    position: absolute;
    width: 28px;
    height: 28px;
    background: linear-gradient(135deg, var(--gold-primary), #DAA520);
    color: var(--red-dark);
    font-size: 0.75rem;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.blessing-corner.tl { top: -8px; left: -8px; }
.blessing-corner.tr { top: -8px; right: -8px; }
.blessing-corner.bl { bottom: -8px; left: -8px; }
.blessing-corner.br { bottom: -8px; right: -8px; }

.blessing-main {
    text-align: center;
}

.blessing-text-new {
    font-size: 1rem;
    color: var(--gold-light);
    line-height: 1.6;
    margin: 0;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}

/* ===== ç¬¬ä¸‰åŒºå—ï¼šç›²ç›’æƒŠå–œ ===== */
.lucky-section {
    padding: 15px 0;
}

.section-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin-bottom: 20px;
}

.header-line {
    flex: 1;
    max-width: 60px;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold-primary), transparent);
}

.header-title {
    color: var(--gold-primary);
    font-size: 1rem;
    white-space: nowrap;
}

.lucky-box-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 150px;
    perspective: 800px;
}

/* æ–°ç›²ç›’è®¾è®¡ */
.lucky-box-new {
    position: relative;
    width: 100px;
    height: 110px;
    cursor: pointer;
    transform-style: preserve-3d;
    transition: transform 0.4s ease;
}

.lucky-box-new:hover {
    transform: rotateY(-10deg) rotateX(5deg) scale(1.05);
}

.box-shine {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 60px;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.6) 0%, transparent 70%);
    animation: shineFloat 2s ease-in-out infinite;
    pointer-events: none;
}

@keyframes shineFloat {
    0%, 100% { opacity: 0.5; transform: translateX(-50%) translateY(0); }
    50% { opacity: 1; transform: translateX(-50%) translateY(-10px); }
}

.box-lid-new {
    position: absolute;
    top: 0;
    left: -5px;
    right: -5px;
    height: 30px;
    background: linear-gradient(180deg, #FFD700 0%, #DAA520 100%);
    border-radius: 6px 6px 0 0;
    border: 2px solid #B8860B;
    display: flex;
    align-items: center;
    justify-content: center;
    transform-origin: bottom center;
    transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    z-index: 2;
}

.lid-text {
    font-size: 1.2rem;
    color: #8B0000;
    font-weight: bold;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
}

.box-body-new {
    position: absolute;
    top: 25px;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(180deg, #DC143C 0%, #8B0000 100%);
    border-radius: 0 0 8px 8px;
    border: 2px solid #5C0000;
    border-top: none;
    overflow: hidden;
}

.box-body-new::before {
    content: '?';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2.5rem;
    color: rgba(255, 215, 0, 0.3);
    animation: questionPulse 1.5s ease-in-out infinite;
}

@keyframes questionPulse {
    0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
    50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.1); }
}

.box-shadow {
    position: absolute;
    bottom: -15px;
    left: 10%;
    right: 10%;
    height: 10px;
    background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0.4) 0%, transparent 70%);
}

/* ç›²ç›’å¼€å¯åŠ¨ç”» */
.lucky-box-new.opening .box-lid-new {
    animation: lidOpenNew 0.8s forwards;
}

@keyframes lidOpenNew {
    0% { transform: rotateX(0deg); }
    40% { transform: rotateX(-30deg); }
    100% { transform: rotateX(-110deg) translateY(-10px); }
}

.lucky-box-new.opened {
    display: none;
}

/* å¥–åŠ±å±•ç¤º */
.reward-display {
    text-align: center;
    animation: rewardPop 0.6s ease-out;
}

.reward-display.hidden {
    display: none;
}

@keyframes rewardPop {
    0% { transform: scale(0) rotate(-10deg); opacity: 0; }
    50% { transform: scale(1.15) rotate(5deg); }
    100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

.reward-burst {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 200px;
    height: 200px;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle, rgba(255, 215, 0, 0.3) 0%, transparent 60%);
    animation: burstExpand 1s ease-out forwards;
    pointer-events: none;
}

@keyframes burstExpand {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
}

/* å¥–åŠ±å›¾æ ‡å®¹å™¨ */
.reward-icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100px;
    height: 100px;
    margin: 0 auto;
}

.reward-emoji {
    font-size: 3.5rem;
    animation: emojiFloat 2s ease-in-out infinite;
    filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
}

/* å¥–åŠ±å›¾ç‰‡æ ·å¼ */
.reward-img {
    width: 90px;
    height: 90px;
    object-fit: contain;
    animation: emojiFloat 2s ease-in-out infinite;
    filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
}

@keyframes emojiFloat {
    0%, 100% { transform: translateY(0) rotate(-3deg); }
    50% { transform: translateY(-8px) rotate(3deg); }
}

.reward-name {
    font-size: 1.3rem;
    color: var(--gold-primary);
    margin: 10px 0 5px;
    text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.reward-detail {
    font-size: 0.9rem;
    color: #FFFFFF;
    margin: 5px 0;
}

.reward-wish {
    display: inline-block;
    margin-top: 10px;
    padding: 6px 15px;
    background: rgba(255, 215, 0, 0.15);
    border-radius: 15px;
    font-size: 0.85rem;
    color: var(--gold-light);
    font-style: italic;
}

.box-level-tag {
    text-align: center;
    margin-top: 15px;
}

#box-level-text {
    font-size: 0.8rem;
    color: var(--gold-light);
    padding: 4px 12px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
}

/* ===== ç¬¬å››åŒºå—ï¼šç¤¾äº¤ä¸æ’è¡Œ ===== */
.social-section-new {
    padding: 10px 0;
}

.share-row {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 15px;
}

.share-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 10px 18px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.75rem;
    color: white;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(0, 0, 0, 0.2) 100%);
    border: 1px solid rgba(255, 215, 0, 0.3);
    backdrop-filter: blur(5px);
}

.share-btn .btn-emoji {
    font-size: 1.3rem;
}

.share-btn:hover {
    transform: translateY(-3px);
    border-color: var(--gold-primary);
    box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
}

.share-btn:active {
    transform: translateY(0);
}

/* æ’è¡Œæ¦œç´§å‡‘ç‰ˆ */
.leaderboard-compact {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 12px;
    padding: 12px;
    border: 1px solid rgba(255, 215, 0, 0.15);
}

.lb-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(255, 215, 0, 0.15);
}

.lb-header span {
    color: var(--gold-primary);
    font-size: 0.9rem;
    font-weight: bold;
}

.lb-more {
    background: transparent;
    border: 1px solid rgba(255, 215, 0, 0.5);
    color: var(--gold-light);
    padding: 3px 10px;
    border-radius: 10px;
    font-size: 0.7rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.lb-more:hover {
    background: var(--gold-primary);
    color: var(--red-dark);
}

.lb-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.lb-item {
    display: flex;
    align-items: center;
    padding: 8px 10px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.03);
}

.lb-item.gold {
    background: linear-gradient(90deg, rgba(255, 215, 0, 0.15) 0%, transparent 100%);
}

.lb-item.silver {
    background: linear-gradient(90deg, rgba(192, 192, 192, 0.15) 0%, transparent 100%);
}

.lb-rank {
    font-size: 1.1rem;
    width: 30px;
}

.lb-name {
    flex: 1;
    color: #FFF;
    font-size: 0.85rem;
    margin-left: 8px;
}

.lb-score {
    color: var(--gold-primary);
    font-weight: bold;
    font-size: 0.9rem;
}

/* ===== ç¬¬äº”åŒºå—ï¼šæ“ä½œæŒ‰é’® ===== */
.action-section {
    display: flex;
    gap: 12px;
    padding: 10px 0;
}

.action-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 14px 20px;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}

.action-btn.primary {
    background: linear-gradient(135deg, var(--gold-primary) 0%, #FFA500 100%);
    color: var(--red-dark);
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
}

.action-btn.primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
}

.action-btn.secondary {
    background: rgba(255, 255, 255, 0.1);
    color: #FFF;
    border: 1px solid rgba(255, 215, 0, 0.3);
}

.action-btn.secondary:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: var(--gold-primary);
}

.action-btn:active {
    transform: translateY(0);
}

/* ===== åº•éƒ¨å­¦é™¢æ ‡è¯† ===== */
.college-footer {
    text-align: center;
    padding: 15px 0 20px;
    border-top: 1px solid rgba(255, 215, 0, 0.1);
    margin-top: auto;
}

.college-badge {
    font-size: 2rem;
    margin-bottom: 8px;
}

.college-name {
    font-size: 0.8rem;
    color: var(--gold-light);
    margin: 0 0 5px;
}

.college-slogan {
    font-size: 0.7rem;
    color: rgba(255, 215, 0, 0.5);
    margin: 0;
    letter-spacing: 2px;
}

/* ===== å“åº”å¼é€‚é… ===== */
@media (max-width: 380px) {
    .end-page-container {
        padding: 15px 10px;
        gap: 15px;
    }

    .score-number {
        font-size: 3.2rem;
    }

    .stats-bar {
        padding: 10px 15px;
        gap: 6px;
    }

    .stat-item {
        font-size: 0.8rem;
    }

    .blessing-card-new {
        padding: 20px 15px;
    }

    .share-btn {
        padding: 8px 14px;
    }

    .action-btn {
        padding: 12px 15px;
        font-size: 0.9rem;
    }
}

@media (min-height: 800px) {
    .end-page-container {
        gap: 25px;
    }

    .hero-section {
        padding: 20px 0;
    }

    .lucky-section {
        padding: 20px 0;
    }
}

/* ==================== ğŸ† æ’è¡Œæ¦œæ ·å¼ ==================== */
.leaderboard-section {
    margin-top: 20px;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 15px;
    padding: 15px;
    border: 1px solid rgba(255, 215, 0, 0.2);
}

.leaderboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 12px;
    border-bottom: 1px solid rgba(255, 215, 0, 0.2);
    margin-bottom: 10px;
}

.lb-title {
    font-size: 1.1rem;
    color: var(--gold-primary);
    font-weight: bold;
}

.lb-subtitle {
    font-size: 0.75rem;
    color: var(--gold-light);
    opacity: 0.7;
}

.leaderboard-list-full {
    display: flex;
    flex-direction: column;
    gap: 6px;
    max-height: 300px;
    overflow-y: auto;
}

.lb-row {
    display: flex;
    align-items: center;
    padding: 10px 12px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 8px;
    transition: all 0.3s ease;
}

.lb-row:hover {
    background: rgba(255, 255, 255, 0.08);
}

.lb-row.gold {
    background: linear-gradient(90deg, rgba(255, 215, 0, 0.2) 0%, transparent 100%);
}

.lb-row.silver {
    background: linear-gradient(90deg, rgba(192, 192, 192, 0.2) 0%, transparent 100%);
}

.lb-row.bronze {
    background: linear-gradient(90deg, rgba(205, 127, 50, 0.2) 0%, transparent 100%);
}

.lb-row.current {
    border: 1px solid var(--gold-primary);
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}

.lb-row .lb-rank {
    width: 28px;
    font-size: 1rem;
    text-align: center;
}

.lb-row.gold .lb-rank,
.lb-row.silver .lb-rank,
.lb-row.bronze .lb-rank {
    font-size: 1.2rem;
}

.lb-row .lb-score-val {
    flex: 1;
    font-size: 1rem;
    font-weight: bold;
    color: var(--gold-primary);
    margin-left: 10px;
}

.lb-row .lb-time {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
    margin-left: 10px;
}

.lb-row .lb-new {
    font-size: 0.65rem;
    background: var(--gold-primary);
    color: var(--red-dark);
    padding: 2px 6px;
    border-radius: 8px;
    margin-left: 8px;
    font-weight: bold;
}

.lb-empty {
    text-align: center;
    padding: 20px;
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.9rem;
}

.leaderboard-footer {
    margin-top: 12px;
    padding-top: 10px;
    border-top: 1px solid rgba(255, 215, 0, 0.15);
    text-align: center;
}

#current-rank-info {
    font-size: 0.9rem;
    color: var(--gold-light);
}

#current-rank-info.rank-success {
    color: var(--gold-primary);
    font-weight: bold;
}

#current-rank-info.rank-normal {
    color: rgba(255, 255, 255, 0.6);
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.leaderboard-list-full::-webkit-scrollbar {
    width: 4px;
}

.leaderboard-list-full::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 2px;
}

.leaderboard-list-full::-webkit-scrollbar-thumb {
    background: var(--gold-primary);
    border-radius: 2px;
}

/* å“åº”å¼ */
@media (max-width: 380px) {
    .leaderboard-section {
        padding: 12px;
    }

    .lb-row {
        padding: 8px 10px;
    }

    .lb-row .lb-score-val {
        font-size: 0.9rem;
    }

    .lb-row .lb-time {
        font-size: 0.7rem;
    }
}

/* ================================================================
   ğŸ“±ğŸ“±ğŸ“± ç§»åŠ¨ç«¯æ·±åº¦ä¼˜åŒ– - å…¨é¢é€‚é… ğŸ“±ğŸ“±ğŸ“±
================================================================ */

/* === é€šç”¨ç§»åŠ¨ç«¯ä¼˜åŒ– === */
@media (max-width: 768px) {
    /* å¼€å§‹é¡µé¢æ•´ä½“å¸ƒå±€ */
    #start-screen {
        padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    }

    .content-3d {
        padding: 15px 10px 30px;
        width: 100%;
        max-width: 100%;
    }

    /* å­¦é™¢æ ‡è¯†ç¼©å° */
    .college-badge {
        margin-bottom: 10px;
    }

    .badge-inner {
        padding: 8px 15px;
        gap: 8px;
    }

    .badge-icon {
        font-size: 1.5rem;
    }

    .college-name {
        font-size: 0.85rem;
    }

    .department-name {
        font-size: 0.7rem;
    }

    /* æ ‡é¢˜ç¼©å° */
    .title-3d-container {
        margin: 15px 0;
    }

    .year-ribbon {
        padding: 4px 15px;
        font-size: 0.75rem;
    }

    .game-title-3d {
        gap: 5px;
    }

    .title-char-3d {
        font-size: 2.8rem;
    }

    /* è›‡å½¢Logoéšè—æˆ–ç¼©å° */
    .snake-logo-3d {
        margin: 10px 0;
    }

    .segment {
        font-size: 3rem;
    }

    /* æœ€é«˜åˆ†å¡ç‰‡ */
    .high-score-card-3d {
        margin-bottom: 10px;
    }

    .card-face {
        padding: 8px 15px;
        gap: 8px;
    }

    .hs-label {
        font-size: 0.7rem;
    }

    .hs-value {
        font-size: 1.3rem;
    }

    /* ç©æ³•è¯´æ˜ç¼©å° */
    .instruction-card-3d {
        padding: 12px;
        margin: 10px 0;
    }

    .instruction-title {
        font-size: 0.9rem;
        margin-bottom: 8px;
    }

    .item-row {
        gap: 8px;
    }

    .item-desc {
        font-size: 0.6rem;
    }

    .item-emoji {
        font-size: 1.3rem;
    }

    /* å¼€å§‹æŒ‰é’® */
    .btn-start-3d {
        padding: 15px 40px;
        font-size: 1.2rem;
    }

    .btn-content {
        gap: 8px;
    }

    .fullscreen-hint {
        font-size: 0.7rem;
        margin-top: 5px;
    }

    /* éŸ³æ•ˆå¼€å…³ */
    .sound-toggle {
        margin: 8px 0;
    }

    .sound-btn {
        padding: 8px 15px;
        font-size: 0.8rem;
    }

    /* æ“ä½œæç¤º */
    .control-hints-3d {
        gap: 10px;
        font-size: 0.75rem;
        flex-wrap: wrap;
    }

    .hint-card {
        padding: 6px 12px;
    }

    /* åº•éƒ¨æ³¢æµªéšè— */
    .wave-3d-container {
        display: none;
    }

    /* åº•éƒ¨å­¦é™¢æ ‡è¯† */
    .footer-college {
        font-size: 0.7rem;
        padding: 10px 0;
    }

    /* ç¯ç¬¼ç¼©å° */
    .lantern-string {
        gap: 15px;
    }

    .lantern-3d {
        transform: scale(0.7);
    }
}

/* === å°å±æ‰‹æœºæ·±åº¦ä¼˜åŒ– (â‰¤480px) === */
@media (max-width: 480px) {
    .content-3d {
        padding: 10px 8px 25px;
    }

    /* å­¦é™¢æ ‡è¯†è¿›ä¸€æ­¥ç¼©å° */
    .badge-inner {
        padding: 6px 12px;
        gap: 6px;
    }

    .badge-icon {
        font-size: 1.2rem;
    }

    .college-name {
        font-size: 0.75rem;
    }

    .department-name {
        font-size: 0.6rem;
    }

    /* æ ‡é¢˜æ›´å° */
    .year-ribbon {
        padding: 3px 12px;
        font-size: 0.65rem;
    }

    .title-char-3d {
        font-size: 2.3rem;
    }

    /* è›‡å½¢Logoåœ¨å°å±å¹•éšè— */
    .snake-logo-3d {
        display: none;
    }

    /* æœ€é«˜åˆ† */
    .card-face {
        padding: 6px 12px;
    }

    .hs-value {
        font-size: 1.1rem;
    }

    /* ç©æ³•è¯´æ˜ç´§å‡‘ */
    .instruction-card-3d {
        padding: 10px;
        margin: 8px 0;
    }

    .item-row {
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
    }

    .item-emoji {
        font-size: 1.1rem;
    }

    .item-desc {
        font-size: 0.55rem;
    }

    /* å¼€å§‹æŒ‰é’® */
    .btn-start-3d {
        padding: 12px 30px;
        font-size: 1rem;
    }

    /* æ§åˆ¶æç¤ºæ›´ç´§å‡‘ */
    .control-hints-3d {
        gap: 6px;
        font-size: 0.65rem;
    }

    .hint-card {
        padding: 4px 8px;
    }

    .hint-icon {
        font-size: 0.9rem;
    }

    /* ç¯ç¬¼éšè— */
    .lantern-string {
        display: none;
    }
}

/* === è¶…å°å±å¹• (â‰¤360px) === */
@media (max-width: 360px) {
    .content-3d {
        padding: 8px 5px 20px;
    }

    .college-badge {
        margin-bottom: 5px;
    }

    .badge-inner {
        padding: 5px 10px;
    }

    .badge-icon {
        font-size: 1rem;
    }

    .college-name {
        font-size: 0.65rem;
    }

    .department-name {
        font-size: 0.55rem;
    }

    .title-3d-container {
        margin: 10px 0;
    }

    .year-ribbon {
        font-size: 0.6rem;
        padding: 2px 10px;
    }

    .title-char-3d {
        font-size: 2rem;
    }

    .high-score-card-3d {
        margin-bottom: 8px;
    }

    .hs-label {
        font-size: 0.6rem;
    }

    .hs-value {
        font-size: 1rem;
    }

    .instruction-card-3d {
        padding: 8px;
    }

    .instruction-title {
        font-size: 0.75rem;
    }

    .item-row {
        grid-template-columns: repeat(2, 1fr);
    }

    .btn-start-3d {
        padding: 10px 25px;
        font-size: 0.9rem;
        border-radius: 30px;
    }

    .control-hints-3d {
        display: none;
    }

    .footer-college {
        font-size: 0.6rem;
    }
}

/* === æ¸¸æˆé¡µé¢ç§»åŠ¨ç«¯æ·±åº¦ä¼˜åŒ– === */
@media (max-width: 768px) {
    #game-screen {
        touch-action: none;
    }

    /* è§¦æ‘¸åŒºåŸŸé€æ˜åº¦é™ä½ */
    .touch-zone {
        background: transparent;
    }

    .touch-indicator {
        background: rgba(255, 215, 0, 0.15);
        border: 2px solid rgba(255, 215, 0, 0.3);
    }

    /* æš‚åœæŒ‰é’® */
    .pause-btn-3d {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }
}

@media (max-width: 480px) {
    /* HUDæ›´ç´§å‡‘ */
    .game-hud-3d {
        padding: 8px;
    }

    .hud-left-3d, .hud-right-3d {
        gap: 5px;
    }

    .score-content {
        gap: 6px;
    }

    .panel-glow {
        display: none;
    }

    .time-glow {
        display: none;
    }

    .level-glow {
        display: none;
    }

    /* æŠ€èƒ½æ æ›´å° */
    .skill-bar-3d {
        padding: 5px 10px;
        border-radius: 20px;
    }

    .skill-glow {
        display: none;
    }

    /* è§¦æ‘¸æŒ‡ç¤ºå™¨æ›´æ·¡ */
    .touch-indicator {
        opacity: 0.4;
    }

    .touch-zone::after {
        display: none;
    }
}

@media (max-width: 360px) {
    .game-hud-3d {
        padding: 5px;
    }

    .score-panel-3d {
        padding: 4px 8px;
        border-width: 1px;
    }

    .score-icon {
        display: none;
    }

    .time-ring-3d {
        width: 40px;
        height: 40px;
    }

    .skill-bar-3d {
        gap: 5px;
        padding: 4px 8px;
    }

    .skill-btn-3d {
        width: 40px;
        height: 40px;
    }

    .skill-icon-3d {
        font-size: 1rem;
    }

    .skill-name {
        display: none;
    }
}

/* === ç»“æŸé¡µé¢ç§»åŠ¨ç«¯æ·±åº¦ä¼˜åŒ– === */
@media (max-width: 768px) {
    .end-page-container {
        padding: 15px 12px 30px;
    }

    .hero-section {
        padding: 10px 0;
    }

    .score-display-new {
        margin-bottom: 10px;
    }

    .score-number {
        font-size: 3.5rem;
    }

    .score-unit {
        font-size: 1rem;
    }

    .score-rank {
        font-size: 1.5rem;
        padding: 4px 15px;
    }

    .stats-bar {
        padding: 10px 12px;
        gap: 8px;
    }

    .stat-item {
        font-size: 0.75rem;
    }

    .blessing-section {
        padding: 10px 0;
    }

    .blessing-card-new {
        padding: 15px 12px;
    }

    .blessing-text {
        font-size: 1rem;
    }

    .lucky-section {
        padding: 15px 0;
    }

    .lucky-box {
        width: 90px;
        height: 110px;
    }

    .social-section {
        padding: 10px 0;
    }

    .social-buttons {
        gap: 8px;
    }

    .share-btn {
        padding: 8px 12px;
        font-size: 0.75rem;
    }

    .action-section {
        padding: 10px 0;
    }

    .action-buttons {
        gap: 10px;
    }

    .action-btn {
        padding: 12px 20px;
        font-size: 0.9rem;
    }

    .footer-section {
        padding: 10px 0;
    }

    .footer-badge {
        font-size: 1.5rem;
    }

    .footer-college-name {
        font-size: 0.75rem;
    }

    .footer-slogan {
        font-size: 0.65rem;
    }
}

@media (max-width: 480px) {
    .end-page-container {
        padding: 12px 10px 25px;
        gap: 15px;
    }

    .score-number {
        font-size: 3rem;
    }

    .stats-bar {
        flex-wrap: wrap;
        justify-content: center;
    }

    .stat-item {
        font-size: 0.7rem;
    }

    .blessing-text {
        font-size: 0.9rem;
    }

    .lucky-box {
        width: 80px;
        height: 100px;
    }

    .reward-icon {
        font-size: 2.5rem;
    }

    .reward-title {
        font-size: 1rem;
    }

    .reward-desc {
        font-size: 0.75rem;
    }

    .social-buttons {
        flex-wrap: wrap;
        justify-content: center;
    }

    .share-btn {
        flex: 1 1 calc(50% - 8px);
        min-width: 100px;
    }

    .action-btn {
        padding: 10px 15px;
        font-size: 0.85rem;
    }
}

@media (max-width: 360px) {
    .end-page-container {
        padding: 10px 8px 20px;
        gap: 12px;
    }

    .score-number {
        font-size: 2.5rem;
    }

    .score-rank {
        font-size: 1.2rem;
        padding: 3px 12px;
    }

    .stats-bar {
        padding: 8px 10px;
    }

    .stat-item {
        font-size: 0.65rem;
    }

    .blessing-card-new {
        padding: 12px 10px;
    }

    .blessing-text {
        font-size: 0.85rem;
    }

    .lucky-box {
        width: 70px;
        height: 90px;
    }

    .share-btn {
        padding: 6px 10px;
        font-size: 0.7rem;
    }

    .action-btn {
        padding: 8px 12px;
        font-size: 0.8rem;
    }

    .leaderboard-section {
        padding: 10px;
    }

    .lb-title {
        font-size: 0.9rem;
    }

    .lb-row {
        padding: 6px 8px;
    }
}

/* === æ¨ªå±æ¨¡å¼ä¼˜åŒ– === */
@media (max-height: 500px) and (orientation: landscape) {
    /* å¼€å§‹é¡µé¢æ¨ªå± */
    .content-3d {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        padding: 10px;
    }

    .college-badge {
        order: 1;
        width: 100%;
    }

    .title-3d-container {
        order: 2;
        margin: 5px 0;
    }

    .title-char-3d {
        font-size: 2rem;
    }

    .snake-logo-3d,
    .instruction-card-3d,
    .high-score-card-3d {
        display: none;
    }

    .btn-start-3d {
        order: 3;
        margin: 10px;
    }

    .control-hints-3d {
        display: none;
    }

    /* æ¸¸æˆé¡µé¢æ¨ªå± */
    .game-hud-3d {
        padding: 5px 15px;
    }

    .skill-bar-3d {
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
    }

    .touch-indicator {
        bottom: 50%;
        transform: translateY(50%);
    }

    .touch-zone.left .touch-indicator { left: 10px; }
    .touch-zone.right .touch-indicator { right: 10px; }

    .touch-zone::after {
        display: none;
    }

    /* ç»“æŸé¡µé¢æ¨ªå± */
    .end-page-container {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        max-width: 100%;
        padding: 10px;
        gap: 10px;
    }

    .hero-section {
        width: 40%;
        padding: 5px;
    }

    .blessing-section {
        width: 55%;
        padding: 5px;
    }

    .lucky-section,
    .social-section {
        width: 45%;
    }

    .leaderboard-section {
        width: 100%;
    }
}

/* === iOSå®‰å…¨åŒºåŸŸé€‚é… === */
@supports (padding: max(0px)) {
    .game-hud-3d {
        padding-top: max(10px, env(safe-area-inset-top));
        padding-left: max(12px, env(safe-area-inset-left));
        padding-right: max(12px, env(safe-area-inset-right));
    }

    .skill-bar-3d {
        padding-bottom: max(10px, env(safe-area-inset-bottom));
    }

    .end-page-container {
        padding-bottom: max(30px, env(safe-area-inset-bottom));
    }

    .touch-indicator {
        bottom: max(100px, calc(100px + env(safe-area-inset-bottom)));
    }
}

/* === é«˜åˆ†è¾¨ç‡å±å¹•ä¼˜åŒ– === */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .score-panel-3d,
    .time-ring-3d,
    .skill-btn-3d {
        border-width: 1px;
    }
}

/* ================================================================
   2026-02 æ˜¾ç¤ºé€‚é…ä¿®å¤ - å›¾æ ‡å®Œæ•´æ˜¾ç¤º + åŒç«¯å¸ƒå±€ç¨³å®š
================================================================ */
:root {
    --mobile-safe-width: 420px;
    --icon-safe-line-height: 1.15;
}

:is(
    .badge-icon,
    .trophy,
    .header-icon,
    .item-emoji,
    .fire-icon,
    .btn-icon-left,
    .btn-icon-right,
    .sound-on,
    .sound-off,
    .hint-icon,
    .score-icon,
    .combo-fire,
    .skill-icon-3d,
    .buff-icon,
    .achievement-icon,
    .event-icon,
    .pause-icon,
    .pause-icon-large,
    .stat-icon,
    .reward-emoji,
    .share-btn .btn-emoji,
    .touch-indicator,
    .title-deco,
    .record-icon
) {
    line-height: var(--icon-safe-line-height);
    transform-origin: center center;
}

.skill-btn-3d,
.score-panel-3d,
.time-ring-3d,
.reward-icon-wrapper,
.stat-item,
.share-btn {
    overflow: visible;
}

.reward-icon-wrapper {
    isolation: isolate;
}

.reward-img,
.reward-emoji {
    max-width: 100%;
    max-height: 100%;
}

.achievement-content,
.event-content {
    max-width: min(92vw, 420px);
}

@media (max-width: 768px) {
    .content-3d,
    .end-page-container {
        width: min(100%, var(--mobile-safe-width));
        margin-inline: auto;
    }

    .game-hud-3d {
        width: min(100vw, var(--mobile-safe-width));
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        padding-left: max(10px, env(safe-area-inset-left));
        padding-right: max(10px, env(safe-area-inset-right));
    }

    .skill-bar-3d {
        width: min(100vw, var(--mobile-safe-width));
        left: 50%;
        transform: translateX(-50%);
        justify-content: center;
        gap: 10px;
        padding: 0 10px max(8px, env(safe-area-inset-bottom));
        box-sizing: border-box;
    }

    .status-bar-3d {
        width: min(calc(100vw - 14px), var(--mobile-safe-width));
        flex-wrap: wrap;
        justify-content: center;
        gap: 8px;
    }

    .touch-zone {
        width: min(50vw, calc(var(--mobile-safe-width) / 2));
    }

    .touch-zone.left {
        left: max(0px, calc((100vw - var(--mobile-safe-width)) / 2));
    }

    .touch-zone.right {
        right: max(0px, calc((100vw - var(--mobile-safe-width)) / 2));
    }

    .item-3d {
        min-height: 64px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 4px;
    }

    .share-row {
        flex-wrap: wrap;
        gap: 10px;
    }

    .share-btn {
        min-width: 76px;
        min-height: 66px;
    }

    .reward-icon-wrapper {
        width: 88px;
        height: 88px;
    }
}

@media (max-width: 480px) {
    .item-row {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
        gap: 8px;
    }

    .stats-bar {
        flex-wrap: wrap;
        gap: 6px 10px;
        justify-content: center;
    }

    .stat-divider {
        display: none;
    }

    .stat-item {
        min-width: calc(50% - 10px);
        justify-content: center;
    }

    .share-btn {
        flex: 1 1 calc(33.333% - 8px);
        min-width: 84px;
    }

    .pause-btn-3d {
        right: max(8px, calc((100vw - min(100vw, var(--mobile-safe-width))) / 2 + 8px));
        top: max(8px, env(safe-area-inset-top));
    }
}

@media (max-width: 360px) {
    .item-3d {
        min-height: 58px;
        padding: 8px 6px;
    }

    .item-emoji {
        font-size: 1rem !important;
    }

    .skill-btn-3d {
        min-width: 44px;
        min-height: 44px;
    }
}

/* ================================================================
   2026-02-05 ä¿®å¤ - æ‰‹æœºç«¯æç¤º/æŒ‰é’®æ˜¾ç¤º
================================================================ */

/* ä¿®å¤ç§»åŠ¨ç«¯æç¤ºä¿¡æ¯å’Œç‰¹æ•ˆæ˜¾ç¤º */
@media (max-width: 768px) {
    /* ç§»é™¤æ‰€æœ‰ 3D å˜æ¢ï¼Œç¡®ä¿å›¾æ ‡å®Œæ•´æ˜¾ç¤º */
    .skill-btn-3d {
        transform: none !important;
    }

    .skill-btn-3d:not(:disabled):hover,
    .skill-btn-3d:not(:disabled):active {
        transform: scale(1.05) !important;
    }

    .skill-btn-3d.ready {
        transform: none !important;
        animation: skillReadyMobile 1s ease-in-out infinite;
    }

    @keyframes skillReadyMobile {
        0%, 100% { box-shadow: 0 0 15px rgba(76, 175, 80, 0.6); }
        50% { box-shadow: 0 0 25px rgba(76, 175, 80, 0.8); }
    }

    .score-panel-3d,
    .time-ring-3d {
        transform: none !important;
    }

    /* ç¡®ä¿æ‰€æœ‰å›¾æ ‡å®¹å™¨ overflow å¯è§ */
    .skill-btn-3d,
    .pause-btn-3d,
    .buff-item-3d,
    .score-panel-3d,
    .time-ring-3d,
    .combo-display-3d,
    .level-badge-3d {
        overflow: visible;
    }

    /* ç¡®ä¿å›¾æ ‡æœ¬èº«æ­£ç¡®æ˜¾ç¤º */
    .skill-icon-3d,
    .score-icon,
    .buff-icon,
    .pause-icon,
    .combo-fire,
    .time-value-3d {
        display: flex;
        justify-content: center;
        align-items: center;
        line-height: 1.15;
    }

    /* ç¡®ä¿å¾—åˆ†é£˜å­—å®¹å™¨è¦†ç›–å…¨å± */
    .popup-container-3d {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        z-index: 200;
        overflow: visible;
    }

    /* ç¡®ä¿æˆå°±æç¤ºåœ¨ç§»åŠ¨ç«¯æ­£ç¡®æ˜¾ç¤º */
    .achievement-toast-3d {
        position: fixed;
        top: 100px;
        left: 50%;
        transform: translateX(-50%);
        width: auto;
        max-width: 90vw;
        z-index: 300;
    }

    .achievement-content {
        padding: 12px 20px;
        gap: 10px;
    }

    .achievement-icon {
        font-size: 1.5rem;
    }

    .achievement-name {
        font-size: 1rem;
    }

    /* ç¡®ä¿äº‹ä»¶æ¨ªå¹…åœ¨ç§»åŠ¨ç«¯æ­£ç¡®æ˜¾ç¤º */
    .event-banner {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: auto;
        max-width: 90vw;
        z-index: 250;
    }

    .event-content {
        padding: 15px 25px;
        gap: 10px;
    }

    .event-icon {
        font-size: 1.5rem;
    }

    .event-text {
        font-size: 1.2rem;
    }

    /* ä¿®å¤è§¦æ‘¸åŒºåŸŸè¦†ç›–é—®é¢˜ - è¦†ç›–åˆ°å±å¹•åº•éƒ¨ */
    .touch-zone {
        position: fixed;
        top: 0;
        bottom: 0;
        z-index: 50;
        background: transparent;
    }

    .touch-zone.left {
        left: 0;
        right: 50%;
        width: auto;
    }

    .touch-zone.right {
        right: 0;
        left: 50%;
        width: auto;
    }

    /* è§¦æ‘¸æŒ‡ç¤ºå™¨æ”¾åœ¨é¡µé¢æœ€åº•éƒ¨ */
    .touch-indicator {
        position: absolute;
        bottom: 15px;
        transform: none;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: rgba(255, 215, 0, 0.25);
        border: 2px solid rgba(255, 215, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.5rem;
        color: rgba(255, 215, 0, 0.9);
        pointer-events: none;
        animation: touchPulse 2s ease-in-out infinite;
    }

    .touch-zone.left .touch-indicator {
        left: 30px;
        right: auto;
    }

    .touch-zone.right .touch-indicator {
        right: 30px;
        left: auto;
    }

    /* ä¿®å¤æš‚åœæŒ‰é’®ä½ç½® */
    .pause-btn-3d {
        position: fixed;
        top: 10px;
        right: 10px;
        width: 44px;
        height: 44px;
        z-index: 150;
    }

    .pause-icon {
        font-size: 1.2rem;
    }
}

/* å°å±å¹•æ‰‹æœºè¿›ä¸€æ­¥ä¼˜åŒ– */
@media (max-width: 480px) {
    .touch-zone {
        bottom: 0;
    }

    .touch-indicator {
        bottom: 12px;
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
    }

    .touch-zone.left .touch-indicator {
        left: 25px;
    }

    .touch-zone.right .touch-indicator {
        right: 25px;
    }

    .achievement-toast-3d {
        top: 80px;
    }

    .achievement-content {
        padding: 10px 15px;
    }

    .event-content {
        padding: 12px 20px;
    }

    .pause-btn-3d {
        top: 8px;
        right: 8px;
        width: 40px;
        height: 40px;
    }

    .pause-icon {
        font-size: 1rem;
    }
}

/* è¶…å°å±å¹• */
@media (max-width: 360px) {
    .touch-zone {
        bottom: 0;
    }

    .touch-indicator {
        bottom: 10px;
        width: 44px;
        height: 44px;
        font-size: 1.1rem;
    }

    .touch-zone.left .touch-indicator {
        left: 20px;
    }

    .touch-zone.right .touch-indicator {
        right: 20px;
    }

    .achievement-toast-3d {
        top: 70px;
        max-width: 95vw;
    }

    .achievement-content {
        padding: 8px 12px;
        gap: 8px;
    }

    .achievement-icon {
        font-size: 1.3rem;
    }

    .achievement-name {
        font-size: 0.9rem;
    }

    .event-content {
        padding: 10px 15px;
    }

    .event-icon {
        font-size: 1.3rem;
    }

    .event-text {
        font-size: 1rem;
    }

    .pause-btn-3d {
        top: 6px;
        right: 6px;
        width: 36px;
        height: 36px;
    }

    .pause-icon {
        font-size: 0.9rem;
    }
}
